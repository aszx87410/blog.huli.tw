<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="en">
<head>
    <meta charset="utf-8">
<title>PWA Practical Experience Sharing - Huli&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-adsense-account" content="ca-pub-1121865251398741">



            
<link href="https://blog.huli.tw/2018/10/13/pwa-in-action/" rel="alternate" hreflang="zh-TW" />
            
    




    
<link rel="canonical" href="https://blog.huli.tw/2018/10/13/en/pwa-in-action/">
    





    <meta name="description" content="PrefaceRecently, I was busy with the product redesign of my company, switching from the original PHP to backend Go + frontend React SPA. It was divided into two different projects, desktop version and">
<meta property="og:type" content="article">
<meta property="og:title" content="PWA Practical Experience Sharing">
<meta property="og:url" content="https://blog.huli.tw/2018/10/13/en/pwa-in-action/index.html">
<meta property="og:site_name" content="Huli&#39;s blog">
<meta property="og:description" content="PrefaceRecently, I was busy with the product redesign of my company, switching from the original PHP to backend Go + frontend React SPA. It was divided into two different projects, desktop version and">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://user-images.githubusercontent.com/2755720/49352007-d3c09e00-f6f0-11e8-8106-01335810b01a.png">
<meta property="article:published_time" content="2018-10-13T14:10:00.000Z">
<meta property="article:modified_time" content="2023-06-20T05:10:49.071Z">
<meta property="article:author" content="Huli">
<meta property="article:tag" content="Front-end">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/2755720/49352007-d3c09e00-f6f0-11e8-8106-01335810b01a.png">



<link rel="alternative" href="/atom.xml" title="PWA Practical Experience Sharing" type="application/atom+xml">



<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">


<link rel="stylesheet" href="/css/bulma.css?v=2.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />


<link rel="stylesheet" href="/css/style.css?v=4.css">





    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1393J2EVCZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1393J2EVCZ');
</script>


    


<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <script>
        if (localStorage.getItem('dark-mode')) {
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode')
            }
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode')
            }
        }
    </script>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/en">
                
                    
                    Huli&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/en/archives">Archive</a>
            
            <a class="navbar-item "
               href="/en/categories">Categories</a>
            
            <a class="navbar-item "
               href="/en/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="Table of Contents">
                    Table of Contents
                </a>
                <div class="navbar-dropdown">
                    
                    
                    
                    
                    <a class="navbar-item" href="#preface">1&nbsp;&nbsp;<b>Preface</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#what-is-pwa">2&nbsp;&nbsp;<b>What is PWA?</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#manifestjson">3&nbsp;&nbsp;<b>manifest.json</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#service-worker">4&nbsp;&nbsp;<b>Service Worker</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#add-to-home-screen-banner">5&nbsp;&nbsp;<b>Add to home screen banner</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#manifest-observation">6&nbsp;&nbsp;<b>Manifest Observation</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#conclusion">7&nbsp;&nbsp;<b>Conclusion</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" target="_blank" title="Twitter" href="https://twitter.com/aszx87410">
                
                <i class="fab fa-twitter"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="RSS" href="/atom-en.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
               
            
            <a class="navbar-item btn-dark-mode" title="dark-mode" href="#">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15" height="15" viewBox="0 0 256 256" xml:space="preserve">
                    <defs>
                    </defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >
                        <path d="M 87.823 60.7 c -0.463 -0.423 -1.142 -0.506 -1.695 -0.214 c -15.834 8.398 -35.266 2.812 -44.232 -12.718 c -8.966 -15.53 -4.09 -35.149 11.101 -44.665 c 0.531 -0.332 0.796 -0.963 0.661 -1.574 c -0.134 -0.612 -0.638 -1.074 -1.259 -1.153 c -9.843 -1.265 -19.59 0.692 -28.193 5.66 C 13.8 12.041 6.356 21.743 3.246 33.35 S 1.732 57.08 7.741 67.487 c 6.008 10.407 15.709 17.851 27.316 20.961 C 38.933 89.486 42.866 90 46.774 90 c 7.795 0 15.489 -2.044 22.42 -6.046 c 8.601 -4.966 15.171 -12.43 18.997 -21.586 C 88.433 61.79 88.285 61.123 87.823 60.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: #ffa716; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                    </g>
                    </svg>
                </div>
            </a>
            
               <a class="navbar-item" href="/2018/10/13/pwa-in-action/">中文</a>
            
            

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
      
      <div data-nosnippet class="self-notice">
        If you have any thoughts on my blog or articles and you want to let me know, you can either post a comment below(public) or tell me via this <a href="https://forms.gle/SjJZ4cnNs6NnjXQG8" target="_blank">feedback form</a>
      </div>
      
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            PWA Practical Experience Sharing
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-10-13T14:10:00.000Z" itemprop="datePublished">13 October 2018</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/en/categories/Front-end/">Front-end</a>
        </span>
        
        
        
        <spen data-nosnippet class="column is-narrow">(Translated by ChatGPT)</span>
        
    </div>
    
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h1><span id="preface">Preface</span></h1><p>Recently, I was busy with the product redesign of my company, switching from the original PHP to backend Go + frontend React SPA. It was divided into two different projects, desktop version and mobile version. Since we were redesigning, we naturally wanted to include the latest and coolest PWA in our goals. Although I had heard of PWA for a long time, I had never implemented it before, so I had the opportunity to try it out.</p>
<p>Now that the product has been redesigned and has been online for two or three months, it has gradually stabilized. In the process of optimizing PWA, I have gained some experience that I can share with everyone.</p>
<p>Before giving some practical examples, let’s talk about what PWA is.</p>
<span id="more"></span>

<h1><span id="what-is-pwa">What is PWA?</span></h1><p>From Google’s official document: <a target="_blank" rel="noopener" href="https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=zh-tw">Your First Progressive Web App</a>, we can see some detailed definitions of PWA. However, I don’t like this kind of standardized rules. For me, PWA is a Web App that is very similar to Native App, and browser support also accounts for a large part of it.</p>
<p>In the past, no matter how much your website looked like a Native App, you still had two difficulties that couldn’t be overcome: when offline, it was GG, and it couldn’t be installed on a mobile phone. So no matter how you look at it, people know that you are a Web App and will never look like Native.</p>
<p>However, since the browser began to support Service Worker and manifest, these two points have been overcome! Thanks to Service Worker, the webpage can also operate when offline, and you can write code to decide what to render. The browser’s “Add to Home Screen” function makes it possible to install Web Apps, and developers can also use manifest.json to customize some content, such as the startup screen and the name displayed on the home screen.</p>
<p>For me, if you can use the above two technologies to successfully install your Web App on a mobile phone and make it look no different from Native App, I think it can be called PWA.</p>
<p>I have shared what PWA looks like on a mobile phone in my previous article (<a target="_blank" rel="noopener" href="https://blog.techbridge.cc/2018/08/18/cors-issue/">CORS is not as simple as I thought</a>), so I won’t go into details here. I remember being scared the first time I experienced installing PWA because it looks no different from Native App. If it is really well done, it should be difficult to distinguish. It is obviously a webpage but looks like Native App, which is PWA.</p>
<p>Next, let’s introduce several important factors of PWA. You must have the following things to do PWA.</p>
<h1><span id="manifestjson">manifest.json</span></h1><p>First, let’s talk about <code>manifest.json</code>. Anyone who has written Android knows that there is something called <code>AndroidManifest.xml</code>. In fact, the two are essentially the same thing, describing some characteristics of this App.</p>
<p>Let’s take a look at the example given in Google’s official document: <a target="_blank" rel="noopener" href="https://developers.google.com/web/fundamentals/web-app-manifest/">The Web App Manifest</a>:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"short_name"</span><span class="token operator">:</span> <span class="token string">"Maps"</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Google Maps"</span><span class="token punctuation">,</span>
  <span class="token property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"src"</span><span class="token operator">:</span> <span class="token string">"/images/icons-192.png"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><span class="token punctuation">,</span>
      <span class="token property">"sizes"</span><span class="token operator">:</span> <span class="token string">"192x192"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token property">"src"</span><span class="token operator">:</span> <span class="token string">"/images/icons-512.png"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><span class="token punctuation">,</span>
      <span class="token property">"sizes"</span><span class="token operator">:</span> <span class="token string">"512x512"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"start_url"</span><span class="token operator">:</span> <span class="token string">"/maps/?source=pwa"</span><span class="token punctuation">,</span>
  <span class="token property">"background_color"</span><span class="token operator">:</span> <span class="token string">"#3367D6"</span><span class="token punctuation">,</span>
  <span class="token property">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span>
  <span class="token property">"scope"</span><span class="token operator">:</span> <span class="token string">"/maps/"</span><span class="token punctuation">,</span>
  <span class="token property">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#3367D6"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>The information given inside is very simple and is closely related to what appears when you add PWA to the home screen. <code>name</code> is the name of your App, which will be displayed on the home screen. However, if you also provide <code>short_name</code>, it will be used first.</p>
<p>Next, <code>icons</code> are the logos that appear on the home screen, which is self-explanatory. <code>start_url</code> is the place where you will connect when you open it from the home screen. Many people will add <code>?source=pwa</code> or something similar, so you can know that this user is using PWA, which is convenient for statistics.</p>
<p>There is a small point to note here, that is, in a certain version of iOS Safari (sorry, I forgot which version it was, but the latest one no longer has this problem), it will not follow <code>start_url</code>! It will be based on the URL you used to install PWA. For example, when you are in <code>https://example.com/test/123</code> and click “Add to Home Screen”, when you open PWA on the home screen, you will connect to this screen.</p>
<p>This part is actually quite troublesome, but fortunately, the latest iOS Safari no longer has this problem, so you don’t have to worry about it.</p>
<p>Another thing to mention is that <code>name</code>, <code>background_color</code>, and <code>icon</code> will automatically form <code>Splash screens</code>, which is the screen you will see when you open PWA. It is automatically composed by Chrome based on these three pieces of information, which means you cannot customize this startup screen.</p>
<p>It will display the background color you specified, then place an icon in the middle and your app name below it. There is nothing else you can adjust, at least for now.</p>
<p>In this regard, iOS is different. iOS does not support this type of startup screen, but the advantage is that you can set it yourself through html tags!</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
    <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>apple-touch-startup-image<span class="token punctuation">'</span></span>
    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/assets/splash/splash-1125x2436.png<span class="token punctuation">'</span></span>
    <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)<span class="token punctuation">'</span></span>
<span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>There are some size-related settings that you need to prepare a picture for each different device. For details, please refer to: <a target="_blank" rel="noopener" href="https://medium.com/@applification/progressive-web-app-splash-screens-80340b45d210">Progressive Web App Splash Screens</a> or <a target="_blank" rel="noopener" href="https://www.netguru.co/codestories/few-tips-that-will-make-your-pwa-on-ios-feel-like-native">Few Tips That Will Make Your PWA on iOS Feel Like Native</a>.</p>
<p>The difference between iOS and Android is that you can put a picture on the iOS startup screen, so it can be fully customized. You can put whatever you want, and it has a higher degree of freedom than Android.</p>
<p>Also, for the icon part, iOS does not look at your <code>mainfest.json</code> settings, but looks at its own html tag, so you must set an additional icon for iOS to use:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
    <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>apple-touch-icon<span class="token punctuation">'</span></span>
    <span class="token attr-name">sizes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>192x192<span class="token punctuation">'</span></span>
    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/assets/favicons/iOS192x192.png<span class="token punctuation">'</span></span>
<span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>For <code>manifest.json</code>, these are the points to note. In fact, the biggest problem is support, so Google has a <code>PWACompat</code> that can automatically adjust your files and html tags for old browsers. However, someone wrote an article: <a target="_blank" rel="noopener" href="https://medium.com/@firt/you-shouldnt-use-chrome-s-pwacompat-library-in-your-progressive-web-apps-6b3496faab62">You shouldn’t use Chrome’s PWACompat library in your Progressive Web Apps</a> to tell everyone not to use it. The argument is that you cannot generalize like this. You must understand the differences between each platform and browser and then adapt to get the best user experience. This unified adjustment method may look okay in many places, but it is strange in many places.</p>
<p>Since iOS has been mentioned above, let’s talk about some of the differences in iOS. In fact, iOS began to support PWA this year (2018), and the support was quite poor when it was first launched, but it is slowly improving.</p>
<p>These two articles explain the differences in iOS very clearly: <a target="_blank" rel="noopener" href="https://medium.com/@firt/pwas-are-coming-to-ios-11-3-cupertino-we-have-a-problem-2ff49fd7d6ea">PWAs are coming to iOS 11.3: Cupertino, we have a problem</a> and <a target="_blank" rel="noopener" href="https://medium.com/@firt/progressive-web-apps-on-ios-are-here-d00430dee3a7">Progressive Web Apps on iOS are here 🚀</a>.</p>
<p>One of the biggest differences is that many times it does not look at <code>manifest.json</code>, and you need to set some corresponding html tags yourself to make it work. This point needs to be paid special attention to.</p>
<p>Then there is the <code>&lt;meta name=”apple-mobile-web-app-capable” content=”yes”&gt;</code> tag, which is also very important. It mainly tells the browser: “I am ready to provide a full-screen experience, even if the browser UI is hidden.” This article: <a target="_blank" rel="noopener" href="https://medium.com/@firt/dont-use-ios-web-app-meta-tag-irresponsibly-in-your-progressive-web-apps-85d70f4438cb">Don’t use iOS meta tags irresponsibly in your Progressive Web Apps</a> tells you not to abuse this tag, otherwise your Web App experience on Safari will become very poor because many things are not supported.</p>
<p>As for Safari’s biggest problem, I will directly quote one of the paragraphs from <a target="_blank" rel="noopener" href="https://medium.com/@firt/pwas-are-coming-to-ios-11-3-cupertino-we-have-a-problem-2ff49fd7d6ea">PWAs are coming to iOS 11.3: Cupertino, we have a problem</a>:</p>
<blockquote>
<p>Also, it’s a massive problem for apps with two-factor authentication, such as Twitter. If you need to go to another app to get a token or to open a text message or an email, you will get out of the PWA. When you go back to paste the code, you are out of context and, you need to start the login process again losing the validity of that code. It happened to me on Twitter! Which means, the Twitter PWA on iOS is completely unusable for me.</p>
</blockquote>
<p>This is a huge problem, especially for apps that require two-factor authentication, such as Twitter. If you need to switch to another app to get a token or open a text message or email, you will be taken out of the PWA. When you return to paste the code, you will be out of context and will need to start the login process again, losing the validity of the code. This happened to me on Twitter! This means that the Twitter PWA on iOS is completely unusable for me.</p>
<p>Regarding the issue with iOS and the <code>manifest.json</code>, it is similar to what was mentioned earlier. Now, let’s talk about the second key point of PWAs: Service Worker.</p>
<h1><span id="service-worker">Service Worker</span></h1><p>The purpose of adding a Service Worker is solely for caching. Through the Service Worker (SW), we can intercept and process requests before they are sent. The principle of offline operation is also based on this. We register the SW on the first opening and use it to download and cache static files. If the user goes offline, we can use the cached files to respond, so no real requests are sent, and there is no connection failure.</p>
<p>Google provides a convenient tool called <a target="_blank" rel="noopener" href="https://developers.google.com/web/tools/workbox/">Workbox</a> to help us automatically generate SW and use more convenient syntax to intercept requests.</p>
<p>For example, I use the Webpack plugin:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">workboxPlugin<span class="token punctuation">.</span>InjectManifest</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">swSrc</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> <span class="token constant">SRC_DIR</span><span class="token punctuation">,</span> <span class="token string">'sw.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">swDest</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> <span class="token constant">DIST_DIR</span><span class="token punctuation">,</span> <span class="token string">'sw.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">globDirectory</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> <span class="token constant">DIST_DIR</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">globPatterns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'**/*.&#123;js,css&#125;'</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  
<span class="token comment">//sw.js</span>
<span class="token keyword">let</span> precacheList <span class="token operator">=</span> self<span class="token punctuation">.</span>__precacheManifest <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
workbox<span class="token punctuation">.</span>precaching<span class="token punctuation">.</span><span class="token function">precacheAndRoute</span><span class="token punctuation">(</span>precacheList<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>By writing this, it will automatically find files that meet the rules and add them to the cache list. When you register the SW, those files will be cached.</p>
<p>In addition, Workbox can also listen to URLs:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// sw.js</span>
workbox<span class="token punctuation">.</span>routing<span class="token punctuation">.</span><span class="token function">registerRoute</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(https?:\/\/)(.*)\/api\/(.*)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token parameter">args</span> <span class="token operator">=></span>
    workbox<span class="token punctuation">.</span>strategies
        <span class="token punctuation">.</span><span class="token function">networkFirst</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token literal-property property">cacheName</span><span class="token operator">:</span> <span class="token string">'data-cache'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">workbox<span class="token punctuation">.</span>expiration<span class="token punctuation">.</span>Plugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">maxEntries</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">maxAgeSeconds</span><span class="token operator">:</span> <span class="token number">2592000</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> response
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>The above code caches requests containing <code>api</code> in the path, so API responses that were previously cached can be used when offline.</p>
<p>Workbox provides several strategies for dynamic caching, including <code>staleWhileRevalidate</code>, <code>cacheFirst</code>, <code>networkFirst</code>, <code>networkOnly</code>, and <code>cacheOnly</code>. You can roughly understand the strategy from the name. For more details, please refer to the official document: <a target="_blank" rel="noopener" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies">Workbox Strategies</a>.</p>
<p>Since the introduction of Workbox, we basically don’t need to write SW manually anymore. We can rely on its provided API and functions to automatically generate SW that meets our needs.</p>
<h1><span id="add-to-home-screen-banner">Add to home screen banner</span></h1><p>Finally, let’s talk about the “Install PWA” feature. On iOS Safari, there is no other way but to bring up the menu and select “Add to home screen.” However, on Android Chrome, if you meet certain conditions (have set <code>mainfest.json</code> and registered Service Worker), a cute Install banner will automatically pop up for you.</p>
<p><img src="https://user-images.githubusercontent.com/2755720/49352007-d3c09e00-f6f0-11e8-8106-01335810b01a.png" alt="pwa"></p>
<p>(Image from: <a target="_blank" rel="noopener" href="https://developers.google.com/web/updates/2018/06/a2hs-updates">Changes to Add to Home Screen Behavior</a>)</p>
<p>Depending on the version of Chrome, the behavior is different.</p>
<p>In Chrome 67 and earlier versions, if you don’t use <code>preventDefault()</code> or explicitly call <code>prompt()</code> in the <code>beforeinstallprompt</code> event, a large A2HS banner will appear on the left.</p>
<p>Then, in Chrome 68 and later versions, no matter what you do, the system will automatically display the Mini-infobar. However, if the user closes it, it will take three months to appear again, which is quite long.</p>
<p>Next, both A2HS banners and Mini-infobar will display the A2HS Dialog on the right after the user clicks on them, prompting the user to install the PWA.</p>
<p>However, in Chrome 68 and later versions, you can also use the <code>event.prompt()</code> obtained in <code>beforeinstallprompt</code> to display this dialog through code.</p>
<p>It sounds a bit complicated, right?</p>
<p>Let’s first introduce the <code>beforeinstallprompt</code> event. This event will be triggered when everything is ready and it is confirmed that you meet the conditions to display the prompt. It will pass an event, and you can prevent the prompt from being displayed and save this event:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 此範例來自上面的官方文件</span>
<span class="token keyword">let</span> installPromptEvent<span class="token punctuation">;</span>
  
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'beforeinstallprompt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// Prevent Chrome &lt;= 67 from automatically showing the prompt</span>
  event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Stash the event so it can be triggered later.</span>
  installPromptEvent <span class="token operator">=</span> event<span class="token punctuation">;</span>
  <span class="token comment">// Update the install UI to notify the user app can be installed</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#install-button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Why save it? Because the user may not want to see this popup as soon as they open the website, or they may be checking out and you are interfering with them. So save it and call <code>installPromptEvent.prompt()</code> to display the Dialog at an appropriate time.</p>
<p>But one thing to note is that calling <code>installPromptEvent.prompt()</code> directly is useless. You must do it <code>within a user gesture</code>, which means you have to put it in the click event of a button (or other event triggered by the user) to be effective. Directly calling it is useless and will cause an error message to appear in the console.</p>
<p>I was curious about how it was judged before, but later I found out that there is <code>event.isTrusted</code> that can be used to determine whether an event is triggered actively by the user. Reference: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Event/isTrusted">MDN - Event.isTrusted</a>.</p>
<p>Anyway, because Chrome has different behaviors on different versions, we finally decided to use the following code to have different responses for different versions:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 把 event 存起來</span>
<span class="token keyword">var</span> installPromptEvent
  
<span class="token comment">// 要顯示 prompt 的延遲</span>
<span class="token keyword">var</span> showTime <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">1000</span>
  
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'beforeinstallprompt'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  installPromptEvent <span class="token operator">=</span> e
  <span class="token keyword">var</span> data <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token function">Chrom</span><span class="token punctuation">(</span>e<span class="token operator">|</span>ium<span class="token punctuation">)</span>\\<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([0-9]+)\\.</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> version <span class="token operator">=</span> <span class="token punctuation">(</span>data <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>length <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>version <span class="token operator">&amp;&amp;</span> installPromptEvent<span class="token punctuation">.</span>prompt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  
    <span class="token comment">// 延遲一段時間才顯示 prompt</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 如果 Chrome 版本是 67（含）以下，可以直接呼叫</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>version <span class="token operator">&lt;=</span> <span class="token number">67</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            installPromptEvent<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">&#125;</span>
  
        <span class="token comment">// 否則的話必須透過 user action 主動觸發</span>
        <span class="token comment">// 這邊幫 #root 加上 event listener，代表點擊螢幕任何一處都會顯示 prompt</span>
        document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> addToHomeScreen<span class="token punctuation">)</span>    
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> showTime<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token keyword">function</span> <span class="token function">addToHomeScreen</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>installPromptEvent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        installPromptEvent<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        installPromptEvent <span class="token operator">=</span> <span class="token keyword">null</span>
        document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> addToHomeScreen<span class="token punctuation">)</span> 
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>If it is below 67, you can directly call it to display the prompt. Otherwise, you need to add an event listener, and we also choose to delay it for 30 seconds before displaying it.</p>
<p>Surprisingly, this small change brought amazing growth. Originally, only about 20-30 people installed the PWA per day. After this adjustment, it suddenly increased eight to ten times. I was also surprised when I saw the statistical chart in GA. I didn’t expect the effect to be so good.</p>
<p>Instead of actively asking others to install the PWA, it is better to only require people who are really interested in your product (staying for more than 30 seconds).</p>
<h1><span id="manifest-observation">Manifest Observation</span></h1><p>Finally, let’s take a look at how some well-known PWAs write their <code>manifest.json</code>.</p>
<p>The first is the well-known <a target="_blank" rel="noopener" href="https://www.flipkart.com/">flipkart</a>:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
    <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Flipkart Lite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"short_name"</span><span class="token operator">:</span> <span class="token string">"Flipkart Lite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
            <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"https://img1a.flixcart.com/www/linchpin/batman-returns/logo_lite-cbb3574d.png"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"192x192"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"gcm_sender_id"</span><span class="token operator">:</span> <span class="token string">"656085505957"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"gcm_user_visible_only"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"start_url"</span><span class="token operator">:</span> <span class="token string">"/?start_url=homescreenicon"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"permissions"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"gcm"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"orientation"</span><span class="token operator">:</span> <span class="token string">"portrait"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#2874f0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"background_color"</span><span class="token operator">:</span> <span class="token string">"#2874f0"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Next is the famous <a target="_blank" rel="noopener" href="https://mobile.twitter.com/manifest.json">twitter</a>:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
  <span class="token string-property property">"background_color"</span><span class="token operator">:</span> <span class="token string">"#ffffff"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"It's what's happening. From breaking news and entertainment, sports and politics, to big events and everyday interests."</span><span class="token punctuation">,</span>
  <span class="token string-property property">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"gcm_sender_id"</span><span class="token operator">:</span> <span class="token string">"49625052041"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"gcm_user_visible_only"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"192x192"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"512x512"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Twitter"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"share_target"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"action"</span><span class="token operator">:</span> <span class="token string">"compose/tweet"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"params"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"title"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"text"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"url"</span><span class="token operator">:</span> <span class="token string">"url"</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token string-property property">"short_name"</span><span class="token operator">:</span> <span class="token string">"Twitter"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"start_url"</span><span class="token operator">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#ffffff"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"scope"</span><span class="token operator">:</span> <span class="token string">"/"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Finally, <a target="_blank" rel="noopener" href="https://events.google.com/io">Google I&#x2F;O 2018</a>:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Google I/O 2018"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"short_name"</span><span class="token operator">:</span> <span class="token string">"I/O 2018"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"start_url"</span><span class="token operator">:</span> <span class="token string">"./?utm_source=web_app_manifest"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#6284F3"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"background_color"</span><span class="token operator">:</span> <span class="token string">"#6284F3"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
    <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"static/images/homescreen/homescreen57.png"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"57x57"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"static/images/homescreen/homescreen114.png"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"114x114"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"static/images/homescreen/homescreen128.png"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"128x128"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"static/images/homescreen/homescreen144.png"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"144x144"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"static/images/homescreen/homescreen192.png"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"192x192"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"static/images/homescreen/homescreen512.png"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"512x512"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"prefer_related_applications"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string-property property">"related_applications"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
    <span class="token string-property property">"platform"</span><span class="token operator">:</span> <span class="token string">"play"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"com.google.samples.apps.iosched"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"gcm_sender_id"</span><span class="token operator">:</span> <span class="token string">"103953800507"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>I like to observe these things from other people’s homes, because you will find a lot of information that you missed or couldn’t find when you searched, and you will also have a concept of which attributes are particularly commonly used. In addition to <code>manifest.json</code>, you can also refer to the tags in html to learn a lot.</p>
<h1><span id="conclusion">Conclusion</span></h1><p>Recently, after struggling with PWA and being squeezed by PM, I collected a lot of information related to PWA and referred to many useful articles. I sincerely thank those predecessors for sharing, which can avoid later generations from stepping on a lot of pits.</p>
<p>Although the experience on iOS is a bit poor, overall, I still have high hopes for the development of PWA. The first is that Google strongly promotes it, and the second is that the support of browsers is getting higher and higher. As I said above, iOS Safari has slowly fixed the bugs, and future functions will be more complete.</p>
<p>Moreover, the user experience of PWA is very good, with acceptable speed and the flexibility of the Web. The key is that there is no need to download it from Google Play, which eliminates a threshold for conversion (although there is still a threshold for installing PWA, but I think it is easier), and Chrome also provides many mechanisms for PWA. I hope users can install PWA on their mobile phones.</p>
<p>In short, this article mainly shares some of my experiences while working on PWA. If you have any insights, please feel free to leave a comment below and share with me. Thank you.</p>
<p>Further reading and references:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/web/updates/2018/06/a2hs-updates">Changes to Add to Home Screen Behavior</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@applification/progressive-web-app-splash-screens-80340b45d210">Progressive Web App Splash Screens</a></li>
<li><a target="_blank" rel="noopener" href="https://www.netguru.co/codestories/few-tips-that-will-make-your-pwa-on-ios-feel-like-native">Few Tips That Will Make Your PWA on iOS Feel Like Native</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@firt/pwas-are-coming-to-ios-11-3-cupertino-we-have-a-problem-2ff49fd7d6ea">PWAs are coming to iOS 11.3: Cupertino, we have a problem</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.techbridge.cc/2016/07/23/progressive-web-app/">Will Progressive Web App be the future trend?</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/web/showcase/">PWA case studies</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/dev-channel/a-pinterest-progressive-web-app-performance-case-study-3bd6ed2e6154">A Pinterest Progressive Web App Performance Case Study</a></li>
</ol>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/en/tags/Front-end/">#Front-end</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2018/11/10/en/javascript-hoisting-and-tdz/">I know you understand hoisting, but how deep do you know?</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2018/09/14/en/aws-lambda-and-github-api/">AWS Lambda + GitHub API + Google Sheet = Automated Sign-in System</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">Comments</h3>
    <script src="https://utteranc.es/client.js"
        repo="aszx87410/huli-blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2024 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>English</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            <!-- NOTE: 永遠回到首頁 -->
            
                <a href="/2018/10/13/pwa-in-action/" class="dropdown-item">
                    繁體中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>



    
    
    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js?v=3.js"></script>


    
</body>
</html>