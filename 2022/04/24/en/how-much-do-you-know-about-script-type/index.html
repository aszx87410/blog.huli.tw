<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="en">
<head>
    <meta charset="utf-8">
<title>How much do you know about script type? - Huli&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1">


            
<link href="https://blog.huli.tw/2022/04/24/how-much-do-you-know-about-script-type/" rel="alternate" hreflang="zh-TW" />
            
    




    
<link rel="canonical" href="https://blog.huli.tw/2022/04/24/en/how-much-do-you-know-about-script-type/">
    





    <meta name="description" content="A while ago, I happened to play a lot of topics related to content type, so I decided to wrote an article about it.">
<meta property="og:type" content="article">
<meta property="og:title" content="How much do you know about script type?">
<meta property="og:url" content="https://blog.huli.tw/2022/04/24/en/how-much-do-you-know-about-script-type/index.html">
<meta property="og:site_name" content="Huli&#39;s blog">
<meta property="og:description" content="A while ago, I happened to play a lot of topics related to content type, so I decided to wrote an article about it.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.huli.tw/img/how-much-do-you-know-about-script-type/cover-en.png">
<meta property="article:published_time" content="2022-04-24T02:20:16.000Z">
<meta property="article:modified_time" content="2023-06-20T05:46:56.911Z">
<meta property="article:author" content="Huli">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.huli.tw/img/how-much-do-you-know-about-script-type/cover-en.png">



<link rel="alternative" href="/atom.xml" title="How much do you know about script type?" type="application/atom+xml">



<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">


<link rel="stylesheet" href="/css/bulma.css?v=2.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />


<link rel="stylesheet" href="/css/style.css?v=4.css">





    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1393J2EVCZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1393J2EVCZ');
</script>


    


<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <script>
        if (localStorage.getItem('dark-mode')) {
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode')
            }
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode')
            }
        }
    </script>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/en">
                
                    
                    Huli&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/en/archives">Archive</a>
            
            <a class="navbar-item "
               href="/en/categories">Categories</a>
            
            <a class="navbar-item "
               href="/en/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="Table of Contents">
                    Table of Contents
                </a>
                <div class="navbar-dropdown">
                    
                    
                    
                    
                    <a class="navbar-item" href="#question-one">1.1&nbsp;&nbsp;Question one</a>
                    
                    
                    
                    <a class="navbar-item" href="#question-two">1.2&nbsp;&nbsp;Question two</a>
                    
                    
                    
                    <a class="navbar-item" href="#question-three">1.3&nbsp;&nbsp;Question three</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#question-1-acceptable-content-type-for-ltscriptgt">2&nbsp;&nbsp;<b>Question 1: Acceptable content type for &amp;lt;script&amp;gt;</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#question-2-acceptable-types-of-ltscriptgt">3&nbsp;&nbsp;<b>Question 2: Acceptable types of &amp;lt;script&amp;gt;</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#question-3-content-type">4&nbsp;&nbsp;<b>Question 3: content type</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" target="_blank" title="Twitter" href="https://twitter.com/aszx87410">
                
                <i class="fab fa-twitter"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="RSS" href="/atom-en.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
               
            
            <a class="navbar-item btn-dark-mode" title="dark-mode" href="#">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15" height="15" viewBox="0 0 256 256" xml:space="preserve">
                    <defs>
                    </defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >
                        <path d="M 87.823 60.7 c -0.463 -0.423 -1.142 -0.506 -1.695 -0.214 c -15.834 8.398 -35.266 2.812 -44.232 -12.718 c -8.966 -15.53 -4.09 -35.149 11.101 -44.665 c 0.531 -0.332 0.796 -0.963 0.661 -1.574 c -0.134 -0.612 -0.638 -1.074 -1.259 -1.153 c -9.843 -1.265 -19.59 0.692 -28.193 5.66 C 13.8 12.041 6.356 21.743 3.246 33.35 S 1.732 57.08 7.741 67.487 c 6.008 10.407 15.709 17.851 27.316 20.961 C 38.933 89.486 42.866 90 46.774 90 c 7.795 0 15.489 -2.044 22.42 -6.046 c 8.601 -4.966 15.171 -12.43 18.997 -21.586 C 88.433 61.79 88.285 61.123 87.823 60.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: #ffa716; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                    </g>
                    </svg>
                </div>
            </a>
            
               <a class="navbar-item" href="/2022/04/24/how-much-do-you-know-about-script-type/">中文</a>
            
            

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
      
      <div data-nosnippet class="self-notice">
        If you have any thoughts on my blog or articles and you want to let me know, you can either post a comment below(public) or tell me via this <a href="https://forms.gle/SjJZ4cnNs6NnjXQG8" target="_blank">feedback form</a>
      </div>
      
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            How much do you know about script type?
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2022-04-24T02:20:16.000Z" itemprop="datePublished">24 April 2022</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/en/categories/Security/">Security</a>
        </span>
        
        
        
    </div>
    
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <img src="/img/how-much-do-you-know-about-script-type/cover-en.png" style="display:none">

<p>A while ago, I happened to play a lot of topics related to content type, so I decided to wrote an article about it.</p>
<span id="more"></span>

<p>As usual, it’s not interesting to talk about the answer directly, so let’s start with three questions:</p>
<h3><span id="question-one">Question one</span></h3><p>In the code below, what is the content type for <code>a.js</code> to successfully load the code? (Assume MIME type sniffing is off)</p>
<p>For example, <code>text/javascript</code> is one answer, what else?</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com/a.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3><span id="question-two">Question two</span></h3><p>What values ​​can be filled in the “???”? For example, <code>text/javascriptis</code> and <code>module</code> are both correct answer, what else?</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>???<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3><span id="question-three">Question three</span></h3><p>Now that you have a web page. In order to let browser run script after loaded, what should be the content type in the response?</p>
<p>For example, <code>text/html</code> and <code>text/xml</code> are both correct, what else?</p>
<hr>
<p>Let’s take a look at the answer below.</p>
<h2><span id="question-1-acceptable-content-type-for-ltscriptgt">Question 1: Acceptable content type for &lt;script&gt;</span></h2><p>I start thinking about this question because of an XSS challenge made by <a target="_blank" rel="noopener" href="https://twitter.com/ankursundara/status/1460810934713081862">@ankursundara</a> last year: <a target="_blank" rel="noopener" href="https://twitter.com/ankursundara/status/1460810934713081862">https://twitter.com/ankursundara/status/1460810934713081862</a></p>
<p>Part of the code is as follows:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/upload'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        file_storage <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>
        mimetype <span class="token operator">=</span> file_storage<span class="token punctuation">.</span>mimetype<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'application/octet-stream'</span>
        <span class="token keyword">if</span> <span class="token string">'script'</span> <span class="token keyword">in</span> mimetype<span class="token punctuation">:</span>
            mimetype <span class="token operator">=</span> <span class="token string">'application/octet-stream'</span>
        content <span class="token operator">=</span> file_storage<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span>
        <span class="token comment"># dont DOS please</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token string">'mimetype'</span><span class="token punctuation">:</span> mimetype<span class="token punctuation">,</span>
                <span class="token string">'content'</span><span class="token punctuation">:</span> content
            <span class="token punctuation">&#125;</span>
            filename <span class="token operator">=</span> token_hex<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
            store<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> ex<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'/uploads/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> code<span class="token operator">=</span><span class="token number">302</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">return</span> <span class="token string">'Invalid Upload'</span><span class="token punctuation">,</span> <span class="token number">400</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/uploads/&lt;filename>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_upload</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> store<span class="token punctuation">.</span>get<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">if</span> data<span class="token punctuation">:</span>
        data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">'mimetype'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Not Found"</span><span class="token punctuation">,</span> <span class="token number">404</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>after_request</span>
<span class="token keyword">def</span> <span class="token function">headers</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Content-Security-Policy"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"script-src 'self'; object-src 'none';"</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"X-Content-Type-Options"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'nosniff'</span>
    <span class="token keyword">return</span> response<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Simply put, you can upload any file, but if the file’s MIME type has <code>script</code>, it will be <code>application/octet-stream</code>.</p>
<p><code>X-Content-Type-Optionsit</code> is set to <code>nosniff</code>, so we can’t abuse MIME type sniffing.</p>
<p>The goal is to successfully execute XSS.</p>
<p>It is not difficult to see from the above code that an HTML file can be uploaded, but because of <code>script-src &#39;self&#39;</code> CSP, even if HTML can be uploaded, inline script cannot be used.</p>
<p>We can only import script this way: <code>&lt;script src=&quot;/uploads/xxx&quot;&gt;</code>.</p>
<p>But, if the content type of <code>/uploads/xxx</code> is <code>application/octet-stream</code>, Chrome will throw following error:</p>
<blockquote>
<p>Refused to execute script from ‘<a target="_blank" rel="noopener" href="https://uploader.c.hc.lc/uploads/xxx">https://uploader.c.hc.lc/uploads/xxx</a>‘ because its MIME type (‘application&#x2F;octet-stream’) is not executable, and strict MIME type checking is enabled.</p>
</blockquote>
<p>So the goal of this question is very clear, to find a MIME type that does not contain <code>script</code> but can be successfully loaded by the browser.</p>
<p>After seeing this challenge, my first idea is to check the source code of Chromium, it’s easier to find the related part by googling the error message:<code>&quot;strict MIME type checking is enabled&quot; site:https://chromium.googlesource.com/</code></p>
<p>We can find this related file through the search results: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/blink/+/refs/heads/main/Source/core/dom/ScriptLoader.cpp">https://chromium.googlesource.com/chromium/blink/+/refs/heads/main/Source/core/dom/ScriptLoader.cpp</a></p>
<p>This file is very old and deprecated, but at least we know it’s part of blink, so we can find a similiar file in the latest codebase, what I found is: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/renderer/core/script/script_loader.cc">third_party&#x2F;blink&#x2F;renderer&#x2F;core&#x2F;script&#x2F;script_loader.cc</a></p>
<p>You can find this function: <code>IsValidClassicScriptTypeAndLanguage</code> </p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// &lt;specdef href="https://html.spec.whatwg.org/C/#prepare-a-script"></span>
<span class="token keyword">bool</span> <span class="token function">IsValidClassicScriptTypeAndLanguage</span><span class="token punctuation">(</span>
    <span class="token keyword">const</span> String<span class="token operator">&amp;</span> type<span class="token punctuation">,</span>
    <span class="token keyword">const</span> String<span class="token operator">&amp;</span> language<span class="token punctuation">,</span>
    ScriptLoader<span class="token double-colon punctuation">::</span>LegacyTypeSupport support_legacy_types<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// FIXME: IsLegacySupportedJavaScriptLanguage() is not valid HTML5. It is used</span>
  <span class="token comment">// here to maintain backwards compatibility with existing web tests. The</span>
  <span class="token comment">// specific violations are:</span>
  <span class="token comment">// - Allowing type=javascript. type= should only support MIME types, such as</span>
  <span class="token comment">//   text/javascript.</span>
  <span class="token comment">// - Allowing a different set of languages for language= and type=. language=</span>
  <span class="token comment">//   supports Javascript 1.1 and 1.4-1.6, but type= does not.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">IsNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// &lt;spec step="8">the script element has no type attribute but it has a</span>
    <span class="token comment">// language attribute and that attribute's value is the empty string,</span>
    <span class="token comment">// or&lt;/spec></span>
    <span class="token comment">//</span>
    <span class="token comment">// &lt;spec step="8">the script element has neither a type attribute</span>
    <span class="token comment">// nor a language attribute, then&lt;/spec></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>language<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// &lt;spec step="8">Otherwise, the element has a non-empty language attribute;</span>
    <span class="token comment">// let the script block's type string for this script element be the</span>
    <span class="token comment">// concatenation of the string "text/" followed by the value of the language</span>
    <span class="token comment">// attribute.&lt;/spec></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsSupportedJavaScriptMIMEType</span><span class="token punctuation">(</span><span class="token string">"text/"</span> <span class="token operator">+</span> language<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// Not spec'ed.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsLegacySupportedJavaScriptLanguage</span><span class="token punctuation">(</span>language<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// &lt;spec step="8">the script element has a type attribute and its value is</span>
    <span class="token comment">// the empty string, or&lt;/spec></span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// &lt;spec step="8">Otherwise, if the script element has a type attribute, let</span>
    <span class="token comment">// the script block's type string for this script element be the value of</span>
    <span class="token comment">// that attribute with leading and trailing ASCII whitespace</span>
    <span class="token comment">// stripped.&lt;/spec></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsSupportedJavaScriptMIMEType</span><span class="token punctuation">(</span>
            type<span class="token punctuation">.</span><span class="token function">StripWhiteSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// Not spec'ed.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>support_legacy_types <span class="token operator">==</span> ScriptLoader<span class="token double-colon punctuation">::</span>kAllowLegacyTypeInTypeAttribute <span class="token operator">&amp;&amp;</span>
        <span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsLegacySupportedJavaScriptLanguage</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Then, we can search this keyword:<code>IsSupportedJavaScriptMIMEType</code> and find this file: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/common/mime_util/mime_util.cc">third_party&#x2F;blink&#x2F;common&#x2F;mime_util&#x2F;mime_util.cc</a></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//  Support every script type mentioned in the spec, as it notes that "User</span>
<span class="token comment">//  agents must recognize all JavaScript MIME types." See</span>
<span class="token comment">//  https://html.spec.whatwg.org/#javascript-mime-type.</span>
<span class="token keyword">const</span> char<span class="token operator">*</span> <span class="token keyword">const</span> kSupportedJavascriptTypes<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"application/ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"application/javascript"</span><span class="token punctuation">,</span>
    <span class="token string">"application/x-ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"application/x-javascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.1"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.3"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.4"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.5"</span><span class="token punctuation">,</span>
    <span class="token string">"text/jscript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/livescript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/x-ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/x-javascript"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>You can also see the URL of the spec from the comments. The list given is the same, and this list is basically the answer to the first question. The above MIME types can be loaded as script.</p>
<p>But we can find one thing, that is, every MIME type contains <code>script</code>.</p>
<p>At that time, I got stuck at this point. Later, the author released a hint: <code>Origin Trials</code>. Follow the hint I found a feature called <a target="_blank" rel="noopener" href="https://web.dev/web-bundles/">Web Bundles</a>. This is the answer to the XSS challenge.</p>
<p>What is Web Bundles?</p>
<p>To put it simply, Web Bundles is a feature that you can package a bunch of data (HTML, CSS, JS…) together into a .wbn file. The above article mentions an example that your friend wants to share with a web game with you, but he can’t do it because there is no internet connection.</p>
<p>But through the Web Bundles, he can package the web game into a .wbn file and send it to you. After you receive it via bluetooth or airdrop, you can just open it in the browser, just like an app.</p>
<p>In addition to loading the entire app, you can also load specific resources from the Web Bundle. You can find the detail here:<a target="_blank" rel="noopener" href="https://github.com/WICG/webpackage/blob/main/explainers/subresource-loading.md">Explainer: Subresource loading with Web Bundles</a>.</p>
<p>Here is the example from the article:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>webbundle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
   <span class="token string-property property">"source"</span><span class="token operator">:</span> <span class="token string">"https://example.com/dir/subresources.wbn"</span><span class="token punctuation">,</span>
   <span class="token string-property property">"resources"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://example.com/dir/a.js"</span><span class="token punctuation">,</span> <span class="token string">"https://example.com/dir/b.js"</span><span class="token punctuation">,</span> <span class="token string">"https://example.com/dir/c.png"</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>When you load <code>https://example.com/dir/a.js</code> , the browser will first go to subresources.wbn to find this resource, instead of reaching to the server to download it directly.</p>
<p>So, for the XSS challenge I mentioned in the beginning, the answer is to bundle the JavaScript into a web bundle file, and then load it. It’s MIME type is <code>application/webbundle</code>, so it’s allow.</p>
<p>After web bundle is loaded, we can load script from it.</p>
<p>But why didn’t we see this feature when we looked at the Chromium code?</p>
<p>This is because we are too focus on MIME type, so we only look at<code>IsValidClassicScriptTypeAndLanguage</code>, but we should see another function who call it: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/renderer/core/script/script_loader.cc">GetScriptTypeAtPrepare</a>：</p>
<pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">ScriptLoader::ScriptTypeAtPrepare ScriptLoader::GetScriptTypeAtPrepare(
    const String&amp; type,
    const String&amp; language,
    LegacyTypeSupport support_legacy_types) &#123;
  if (IsValidClassicScriptTypeAndLanguage(type, language,
                                          support_legacy_types)) &#123;
    &#x2F;&#x2F; &lt;spec step&#x3D;&quot;8&quot;&gt;... If the script block&#39;s type string is a JavaScript MIME
    &#x2F;&#x2F; type essence match, the script&#39;s type is &quot;classic&quot;. ...&lt;&#x2F;spec&gt;
    return ScriptTypeAtPrepare::kClassic;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kModule)) &#123;
    &#x2F;&#x2F; &lt;spec step&#x3D;&quot;8&quot;&gt;... If the script block&#39;s type string is an ASCII
    &#x2F;&#x2F; case-insensitive match for the string &quot;module&quot;, the script&#39;s type is
    &#x2F;&#x2F; &quot;module&quot;. ...&lt;&#x2F;spec&gt;
    return ScriptTypeAtPrepare::kModule;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kImportmap)) &#123;
    return ScriptTypeAtPrepare::kImportMap;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kSpeculationrules)) &#123;
    return ScriptTypeAtPrepare::kSpeculationRules;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kWebbundle)) &#123;
    return ScriptTypeAtPrepare::kWebBundle;
  &#125;
  &#x2F;&#x2F; &lt;spec step&#x3D;&quot;8&quot;&gt;... If neither of the above conditions are true, then
  &#x2F;&#x2F; return. No script is executed.&lt;&#x2F;spec&gt;
  return ScriptTypeAtPrepare::kInvalid;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Calling <code>IsValidClassicScriptTypeAndLanguage</code> is just the first step, there are other <code>type</code> as well, and it’s the answer to question two.</p>
<h2><span id="question-2-acceptable-types-of-ltscriptgt">Question 2: Acceptable types of &lt;script&gt;</span></h2><p>Like previous question, it’s also about a CTF challenge. There is a challenge called YACA in PlaidCTF 2022, here is the offical writeup: <a target="_blank" rel="noopener" href="https://github.com/zwade/yaca/tree/master/solution">https://github.com/zwade/yaca/tree/master/solution</a></p>
<p>We know from the code I just posted that  the answer to this question is the answer to the first question (that pile of MIME types) plus the following four types:</p>
<ol>
<li>module</li>
<li>importmap</li>
<li>speculationrules</li>
<li>webbundle</li>
</ol>
<p>We already know <code>module</code> and <code>webbundle</code>, so let’s take a look at importmap and specificationrules.</p>
<p>The specification of import map is here: <a target="_blank" rel="noopener" href="https://github.com/WICG/import-maps">https://github.com/WICG/import-maps</a></p>
<p>What is the problem import map wants to solve?</p>
<p>Although the browser already supports module and import, you still can’t do this on the browser:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">"moment"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> partition <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"lodash"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>You can only write like this:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">"/node_modules/moment/src/moment.js"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> partition <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"/node_modules/lodash-es/lodash.js"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>import map want to solve this problem by introducing a mapping table:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>importmap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
  <span class="token string-property property">"imports"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"moment"</span><span class="token operator">:</span> <span class="token string">"/node_modules/moment/src/moment.js"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"lodash"</span><span class="token operator">:</span> <span class="token string">"/node_modules/lodash-es/lodash.js"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>The challenge we mentioned can be solve by changing the file like this:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>importmap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
  <span class="token string-property property">"imports"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
     <span class="token string-property property">"/js/ast-to-js.mjs"</span><span class="token operator">:</span> <span class="token string">"/js/eval-code.mjs"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Let’s take a look at speculationrules, here is the spec: <a target="_blank" rel="noopener" href="https://github.com/WICG/nav-speculation">https://github.com/WICG/nav-speculation</a></p>
<p>This feature is mainly to solve some problems caused by pre-rendering, I haven’t delved into it. It works like this:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>speculationrules<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
  <span class="token string-property property">"prerender"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span><span class="token string-property property">"source"</span><span class="token operator">:</span> <span class="token string">"list"</span><span class="token punctuation">,</span>
     <span class="token string-property property">"urls"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"/page/2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string-property property">"score"</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token string-property property">"source"</span><span class="token operator">:</span> <span class="token string">"document"</span><span class="token punctuation">,</span>
     <span class="token string-property property">"if_href_matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://*.wikipedia.org/**"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string-property property">"if_not_selector_matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".restricted-section *"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string-property property">"score"</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>It uses a JSON file for the pre-render rule, quite different from <code>&lt;link rel=&quot;prerender&quot;&gt;</code>.</p>
<h2><span id="question-3-content-type">Question 3: content type</span></h2><p>It’s from a challenge called <a target="_blank" rel="noopener" href="https://ctf.zeyu2001.com/2022/securinets-ctf-quals-2022/planetsheet">PlanetSheet</a> in Securinets CTF Quals 2022. When the content type is <code>text/xsl</code> , we can run script via <code>&lt;x:script&gt;</code>.</p>
<p>This classic research is mentioned in each writeup: <a target="_blank" rel="noopener" href="https://github.com/BlackFan/content-type-research/blob/master/XSS.md">Content-Type Research
</a>, you can find the detail in it.</p>
<p>The following five content types can execute XSS in all browsers:</p>
<ol>
<li>text&#x2F;html	</li>
<li>application&#x2F;xhtml+xml	</li>
<li>application&#x2F;xml	</li>
<li>text&#x2F;xml	</li>
<li>image&#x2F;svg+xml</li>
</ol>
<p>I was curious about this behavior, so I checked the source code of Chromium a bit, and found other two content types that are always put together with the others:</p>
<ol>
<li>application&#x2F;rss+xml</li>
<li>application&#x2F;atom+xml</li>
</ol>
<p>Code: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/renderer/core/loader/resource/xsl_style_sheet_resource.cc#45">xsl_style_sheet_resource.cc</a></p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">static void ApplyXSLRequestProperties(FetchParameters&amp; params) &#123;
  params.SetRequestContext(mojom::blink::RequestContextType::XSLT);
  params.SetRequestDestination(network::mojom::RequestDestination::kXslt);
  &#x2F;&#x2F; TODO(japhet): Accept: headers can be set manually on XHRs from script, in
  &#x2F;&#x2F; the browser process, and... here. The browser process can&#39;t tell the
  &#x2F;&#x2F; difference between an XSL stylesheet and a CSS stylesheet, so it assumes
  &#x2F;&#x2F; stylesheets are all CSS unless they already have an Accept: header set.
  &#x2F;&#x2F; Should we teach the browser process the difference?
  DEFINE_STATIC_LOCAL(const AtomicString, accept_xslt,
                      (&quot;text&#x2F;xml, application&#x2F;xml, application&#x2F;xhtml+xml, &quot;
                       &quot;text&#x2F;xsl, application&#x2F;rss+xml, application&#x2F;atom+xml&quot;));
  params.MutableResourceRequest().SetHTTPAccept(accept_xslt);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>However, these two will not be loaded as XML, so I searched and found this bug: <a target="_blank" rel="noopener" href="https://bugs.chromium.org/p/chromium/issues/detail?id=104358">Issue 104358: Consider allowing more types to parse as XML</a>, which mentioned a <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src/+/b4599a15c90a853930187cc751c951beb819c02d%5E%21/#F0">commit</a> in 2009:</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">if (mime_type &#x3D;&#x3D; &quot;application&#x2F;rss+xml&quot; ||
    mime_type &#x3D;&#x3D; &quot;application&#x2F;atom+xml&quot;) &#123;
  &#x2F;&#x2F; Sad face.  The server told us that they wanted us to treat the response
  &#x2F;&#x2F; as RSS or Atom.  Unfortunately, we don&#39;t have a built-in feed previewer
  &#x2F;&#x2F; like other browsers.  We can&#39;t just render the content as XML because
  &#x2F;&#x2F; web sites let third parties inject arbitrary script into their RSS
  &#x2F;&#x2F; feeds.  That leaves us with little choice but to practically ignore the
  &#x2F;&#x2F; response.  In the future, when we have an RSS feed previewer, we can
  &#x2F;&#x2F; remove this logic.
  mime_type.assign(&quot;text&#x2F;plain&quot;);
  response_-&gt;response_head.mime_type.assign(mime_type);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Because the RSS feed may contain third-party cotnent, it’s vulnerable to XSS if it is rendered as XML, so these two are forcibly turned off.</p>
<p>By the way, there is a awesome tool for searching source code: <a target="_blank" rel="noopener" href="https://sourcegraph.com/search">https://sourcegraph.com/search</a></p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/en/tags/Security/">#Security</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2022/04/25/en/intigriti-0422-xss-challenge-author-writeup/">Intigriti 0422 XSS Challenge Author Writeup</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2022/04/24/en/script-type/">What do you know about script type?</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">Comments</h3>
    <script src="https://utteranc.es/client.js"
        repo="aszx87410/huli-blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>English</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            <!-- NOTE: 永遠回到首頁 -->
            
                <a href="/2022/04/24/how-much-do-you-know-about-script-type/" class="dropdown-item">
                    繁體中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>



    
    
    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js?v=3.js"></script>


    
</body>
</html>