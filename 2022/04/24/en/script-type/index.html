<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="en">
<head>
    <meta charset="utf-8">
<title>What do you know about script type? - Huli&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1">


<link href="https://blog.huli.tw/2022/04/24/en/script-type/" rel="alternate" hreflang="en" />


<link href="https://blog.huli.tw/2022/04/24/script-type/" rel="alternate" hreflang="x-default" />


            
<link href="https://blog.huli.tw/2022/04/24/script-type/" rel="alternate" hreflang="zh-TW" />
            





    
<link rel="canonical" href="https://blog.huli.tw/2022/04/24/en/script-type/">
    





    <meta name="description" content="Recently, I encountered many problems related to content type, so I decided to write an article to record them.">
<meta property="og:type" content="article">
<meta property="og:title" content="What do you know about script type?">
<meta property="og:url" content="https://blog.huli.tw/2022/04/24/en/script-type/index.html">
<meta property="og:site_name" content="Huli&#39;s blog">
<meta property="og:description" content="Recently, I encountered many problems related to content type, so I decided to write an article to record them.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.huli.tw/img/script-type/cover-en.png">
<meta property="article:published_time" content="2022-04-24T02:20:16.000Z">
<meta property="article:modified_time" content="2023-06-20T05:46:56.929Z">
<meta property="article:author" content="Huli">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.huli.tw/img/script-type/cover-en.png">



<link rel="alternative" href="/atom.xml" title="What do you know about script type?" type="application/atom+xml">



<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">


<link rel="stylesheet" href="/css/bulma.css?v=2.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />


<link rel="stylesheet" href="/css/style.css?v=4.css">





    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1393J2EVCZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1393J2EVCZ');
</script>


    


<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <script>
        if (localStorage.getItem('dark-mode')) {
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode')
            }
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode')
            }
        }
    </script>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/en">
                
                    
                    Huli&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/en/archives">Archive</a>
            
            <a class="navbar-item "
               href="/en/categories">Categories</a>
            
            <a class="navbar-item "
               href="/en/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="Table of Contents">
                    Table of Contents
                </a>
                <div class="navbar-dropdown">
                    
                    
                    
                    
                    <a class="navbar-item" href="#question-1">1.1&nbsp;&nbsp;Question 1</a>
                    
                    
                    
                    <a class="navbar-item" href="#question-2">1.2&nbsp;&nbsp;Question 2</a>
                    
                    
                    
                    <a class="navbar-item" href="#question-3">1.3&nbsp;&nbsp;Question 3</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#question-1-content-types-that-ltscriptgt-can-accept">2&nbsp;&nbsp;<b>Question 1: Content types that &amp;lt;script&amp;gt; can accept</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#question-2-types-that-ltscriptgt-can-accept">3&nbsp;&nbsp;<b>Question 2: Types that &amp;lt;script&amp;gt; can accept</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#question-3">4&nbsp;&nbsp;<b>Question 3</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" target="_blank" title="Twitter" href="https://twitter.com/aszx87410">
                
                <i class="fab fa-twitter"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="RSS" href="/atom-en.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
               
            
            <a class="navbar-item btn-dark-mode" title="dark-mode" href="#">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15" height="15" viewBox="0 0 256 256" xml:space="preserve">
                    <defs>
                    </defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >
                        <path d="M 87.823 60.7 c -0.463 -0.423 -1.142 -0.506 -1.695 -0.214 c -15.834 8.398 -35.266 2.812 -44.232 -12.718 c -8.966 -15.53 -4.09 -35.149 11.101 -44.665 c 0.531 -0.332 0.796 -0.963 0.661 -1.574 c -0.134 -0.612 -0.638 -1.074 -1.259 -1.153 c -9.843 -1.265 -19.59 0.692 -28.193 5.66 C 13.8 12.041 6.356 21.743 3.246 33.35 S 1.732 57.08 7.741 67.487 c 6.008 10.407 15.709 17.851 27.316 20.961 C 38.933 89.486 42.866 90 46.774 90 c 7.795 0 15.489 -2.044 22.42 -6.046 c 8.601 -4.966 15.171 -12.43 18.997 -21.586 C 88.433 61.79 88.285 61.123 87.823 60.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: #ffa716; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                    </g>
                    </svg>
                </div>
            </a>
            
               <a class="navbar-item" href="/2022/04/24/script-type/">中文</a>
            
            

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
      
      <div data-nosnippet class="self-notice">
        If you have any thoughts on my blog or articles and you want to let me know, you can either post a comment below(public) or tell me via this <a href="https://forms.gle/SjJZ4cnNs6NnjXQG8" target="_blank">feedback form</a>
      </div>
      
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            What do you know about script type?
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2022-04-24T02:20:16.000Z" itemprop="datePublished">24 April 2022</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/en/categories/Security/">Security</a>
        </span>
        
        
        
        <spen data-nosnippet class="column is-narrow">(Translated by ChatGPT)</span>
        
    </div>
    
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <img src="/img/script-type/cover.png" style="display:none">

<p>Recently, I encountered many problems related to content type, so I decided to write an article to record them.</p>
<span id="more"></span>

<p>As usual, it’s not interesting to directly give the answers. Let’s start with three questions:</p>
<h3><span id="question-1">Question 1</span></h3><p>In the following code, what should be the content type of <code>a.js</code> to successfully load the code? (Assuming MIME type sniffing is turned off)</p>
<p>For example, <code>text/javascript</code> is one answer. Are there any other answers?</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com/a.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3><span id="question-2">Question 2</span></h3><p>What values can be filled in “???” below? For example, <code>text/javascript</code> is one answer, and <code>module</code> is also an answer.</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>???<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3><span id="question-3">Question 3</span></h3><p>Now you have a webpage <code>/test</code>. What content-type should be set in the response so that the browser can execute the JS code after loading?</p>
<p>For example, <code>text/html</code> is one answer, and <code>text/xml</code> is also an answer.</p>
<hr>
<p>Now let’s take a look at the answers.</p>
<h2><span id="question-1-content-types-that-ltscriptgt-can-accept">Question 1: Content types that &lt;script&gt; can accept</span></h2><p>The idea for this question and answer comes from a XSS challenge posted by <a target="_blank" rel="noopener" href="https://twitter.com/ankursundara/status/1460810934713081862">@ankursundara</a> at the end of last year: <a target="_blank" rel="noopener" href="https://twitter.com/ankursundara/status/1460810934713081862">https://twitter.com/ankursundara/status/1460810934713081862</a></p>
<p>Part of the code is as follows:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/upload'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        file_storage <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>
        mimetype <span class="token operator">=</span> file_storage<span class="token punctuation">.</span>mimetype<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'application/octet-stream'</span>
        <span class="token keyword">if</span> <span class="token string">'script'</span> <span class="token keyword">in</span> mimetype<span class="token punctuation">:</span>
            mimetype <span class="token operator">=</span> <span class="token string">'application/octet-stream'</span>
        content <span class="token operator">=</span> file_storage<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span>
        <span class="token comment"># dont DOS please</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token string">'mimetype'</span><span class="token punctuation">:</span> mimetype<span class="token punctuation">,</span>
                <span class="token string">'content'</span><span class="token punctuation">:</span> content
            <span class="token punctuation">&#125;</span>
            filename <span class="token operator">=</span> token_hex<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
            store<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> ex<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'/uploads/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> code<span class="token operator">=</span><span class="token number">302</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">return</span> <span class="token string">'Invalid Upload'</span><span class="token punctuation">,</span> <span class="token number">400</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">'/uploads/&lt;filename>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_upload</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> store<span class="token punctuation">.</span>get<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">if</span> data<span class="token punctuation">:</span>
        data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">'mimetype'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Not Found"</span><span class="token punctuation">,</span> <span class="token number">404</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>after_request</span>
<span class="token keyword">def</span> <span class="token function">headers</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Content-Security-Policy"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"script-src 'self'; object-src 'none';"</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"X-Content-Type-Options"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'nosniff'</span>
    <span class="token keyword">return</span> response<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Simply put, you can upload any file, but if the file’s MIME type contains <code>script</code>, it will become <code>application/octet-stream</code>.</p>
<p>And <code>X-Content-Type-Options</code> is set to <code>nosniff</code>, so whatever MIME type is set is what it is.</p>
<p>The goal is to successfully execute XSS.</p>
<p>From the above code, it is not difficult to see that you can upload an HTML file, but because CSP has <code>script-src &#39;self&#39;</code>, even if you can upload HTML, you cannot use inline script, and can only use <code>&lt;script src=&quot;/uploads/xxx&quot;&gt;</code> to introduce it.</p>
<p>And if the content type of <code>/uploads/xxx</code> is <code>application/octet-stream</code>, Chrome will directly display an error message:</p>
<blockquote>
<p>Refused to execute script from ‘<a target="_blank" rel="noopener" href="https://uploader.c.hc.lc/uploads/xxx">https://uploader.c.hc.lc/uploads/xxx</a>‘ because its MIME type (‘application&#x2F;octet-stream’) is not executable, and strict MIME type checking is enabled.</p>
</blockquote>
<p>So the goal of this question is clear: to find a MIME type that does not contain script but can still be successfully loaded by the browser.</p>
<p>After seeing this question, I first went to look at the Chromium source code. Using Google search with the error message just now will make it easier to find: <code>&quot;strict MIME type checking is enabled&quot; site:https://chromium.googlesource.com/</code></p>
<p>Through the search results, we can directly locate this file: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/blink/+/refs/heads/main/Source/core/dom/ScriptLoader.cpp">https://chromium.googlesource.com/chromium/blink/+/refs/heads/main/Source/core/dom/ScriptLoader.cpp</a></p>
<p>However, this file is already very old, but at least we know that it is part of blink, so we can go to <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink">blink</a> in Chromium to find similar files, and we can find <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/renderer/core/script/script_loader.cc">third_party&#x2F;blink&#x2F;renderer&#x2F;core&#x2F;script&#x2F;script_loader.cc</a>.</p>
<p>After comparing the old and new versions, we can find the <code>IsValidClassicScriptTypeAndLanguage</code> function:</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// &lt;specdef href="https://html.spec.whatwg.org/C/#prepare-a-script"></span>
<span class="token keyword">bool</span> <span class="token function">IsValidClassicScriptTypeAndLanguage</span><span class="token punctuation">(</span>
    <span class="token keyword">const</span> String<span class="token operator">&amp;</span> type<span class="token punctuation">,</span>
    <span class="token keyword">const</span> String<span class="token operator">&amp;</span> language<span class="token punctuation">,</span>
    ScriptLoader<span class="token double-colon punctuation">::</span>LegacyTypeSupport support_legacy_types<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// FIXME: IsLegacySupportedJavaScriptLanguage() is not valid HTML5. It is used</span>
  <span class="token comment">// here to maintain backwards compatibility with existing web tests. The</span>
  <span class="token comment">// specific violations are:</span>
  <span class="token comment">// - Allowing type=javascript. type= should only support MIME types, such as</span>
  <span class="token comment">//   text/javascript.</span>
  <span class="token comment">// - Allowing a different set of languages for language= and type=. language=</span>
  <span class="token comment">//   supports Javascript 1.1 and 1.4-1.6, but type= does not.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">IsNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// &lt;spec step="8">the script element has no type attribute but it has a</span>
    <span class="token comment">// language attribute and that attribute's value is the empty string,</span>
    <span class="token comment">// or&lt;/spec></span>
    <span class="token comment">//</span>
    <span class="token comment">// &lt;spec step="8">the script element has neither a type attribute</span>
    <span class="token comment">// nor a language attribute, then&lt;/spec></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>language<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// &lt;spec step="8">Otherwise, the element has a non-empty language attribute;</span>
    <span class="token comment">// let the script block's type string for this script element be the</span>
    <span class="token comment">// concatenation of the string "text/" followed by the value of the language</span>
    <span class="token comment">// attribute.&lt;/spec></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsSupportedJavaScriptMIMEType</span><span class="token punctuation">(</span><span class="token string">"text/"</span> <span class="token operator">+</span> language<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// Not spec'ed.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsLegacySupportedJavaScriptLanguage</span><span class="token punctuation">(</span>language<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// &lt;spec step="8">the script element has a type attribute and its value is</span>
    <span class="token comment">// the empty string, or&lt;/spec></span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// &lt;spec step="8">Otherwise, if the script element has a type attribute, let</span>
    <span class="token comment">// the script block's type string for this script element be the value of</span>
    <span class="token comment">// that attribute with leading and trailing ASCII whitespace</span>
    <span class="token comment">// stripped.&lt;/spec></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsSupportedJavaScriptMIMEType</span><span class="token punctuation">(</span>
            type<span class="token punctuation">.</span><span class="token function">StripWhiteSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// Not spec'ed.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>support_legacy_types <span class="token operator">==</span> ScriptLoader<span class="token double-colon punctuation">::</span>kAllowLegacyTypeInTypeAttribute <span class="token operator">&amp;&amp;</span>
        <span class="token class-name">MIMETypeRegistry</span><span class="token double-colon punctuation">::</span><span class="token function">IsLegacySupportedJavaScriptLanguage</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Then, using <code>IsSupportedJavaScriptMIMEType</code> to search, we can find the supported MIME types in <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/common/mime_util/mime_util.cc">third_party&#x2F;blink&#x2F;common&#x2F;mime_util&#x2F;mime_util.cc</a>:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//  Support every script type mentioned in the spec, as it notes that "User</span>
<span class="token comment">//  agents must recognize all JavaScript MIME types." See</span>
<span class="token comment">//  https://html.spec.whatwg.org/#javascript-mime-type.</span>
<span class="token keyword">const</span> char<span class="token operator">*</span> <span class="token keyword">const</span> kSupportedJavascriptTypes<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"application/ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"application/javascript"</span><span class="token punctuation">,</span>
    <span class="token string">"application/x-ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"application/x-javascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.1"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.3"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.4"</span><span class="token punctuation">,</span>
    <span class="token string">"text/javascript1.5"</span><span class="token punctuation">,</span>
    <span class="token string">"text/jscript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/livescript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/x-ecmascript"</span><span class="token punctuation">,</span>
    <span class="token string">"text/x-javascript"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>From the comments, we can see the location of the spec, and the list provided is the same as the answer to the first question. All these MIME types can be loaded as scripts.</p>
<p>However, we can notice that each MIME type contains a script.</p>
<p>At this point, I got stuck, but the author released a hint called <code>Origin trials</code>, which led to a feature under experimentation called <a target="_blank" rel="noopener" href="https://web.dev/web-bundles/">Web Bundles</a>, which is the answer to this question.</p>
<p>What is a Web Bundle?</p>
<p>Simply put, a Web Bundle is a package that bundles a bunch of data (HTML, CSS, JS…) into a .wbn file. The article mentioned an example: if your friend wants to share a standalone web game with you in an offline environment, it is generally impossible (without considering setting up a server on your own computer).</p>
<p>But with Web Bundles, it can package the game into a .wbn file and send it to you. When you receive it, you can simply throw it into the browser and open it, just like an app.</p>
<p>In addition to loading the entire app, specific resources can also be loaded from the Web Bundle. Here is a complete introduction: <a target="_blank" rel="noopener" href="https://github.com/WICG/webpackage/blob/main/explainers/subresource-loading.md">Explainer: Subresource loading with Web Bundles</a>. The example looks like this:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>webbundle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
   <span class="token string-property property">"source"</span><span class="token operator">:</span> <span class="token string">"https://example.com/dir/subresources.wbn"</span><span class="token punctuation">,</span>
   <span class="token string-property property">"resources"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://example.com/dir/a.js"</span><span class="token punctuation">,</span> <span class="token string">"https://example.com/dir/b.js"</span><span class="token punctuation">,</span> <span class="token string">"https://example.com/dir/c.png"</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>In this way, when you load <code>https://example.com/dir/a.js</code> in a web page, the browser will first look for this resource in subresources.wbn instead of downloading it directly from the server.</p>
<p>So the answer to the XSS challenge mentioned earlier is to package the JS you want to load into a web bundle. Its MIME type is <code>application/webbundle</code>, so it will not be blocked.</p>
<p>Then, load it as shown above, and the MIME type of the JS file loaded from the web bundle will be correct, so it can be executed successfully.</p>
<p>However, why didn’t we see this feature when we were looking at the Chromium code earlier?</p>
<p>This is because we were too focused on the MIME type, so we only looked at <code>IsValidClassicScriptTypeAndLanguage</code>, but we should actually look at <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/renderer/core/script/script_loader.cc">GetScriptTypeAtPrepare</a> that calls it:</p>
<pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">ScriptLoader::ScriptTypeAtPrepare ScriptLoader::GetScriptTypeAtPrepare(
    const String&amp; type,
    const String&amp; language,
    LegacyTypeSupport support_legacy_types) &#123;
  if (IsValidClassicScriptTypeAndLanguage(type, language,
                                          support_legacy_types)) &#123;
    &#x2F;&#x2F; &lt;spec step&#x3D;&quot;8&quot;&gt;... If the script block&#39;s type string is a JavaScript MIME
    &#x2F;&#x2F; type essence match, the script&#39;s type is &quot;classic&quot;. ...&lt;&#x2F;spec&gt;
    return ScriptTypeAtPrepare::kClassic;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kModule)) &#123;
    &#x2F;&#x2F; &lt;spec step&#x3D;&quot;8&quot;&gt;... If the script block&#39;s type string is an ASCII
    &#x2F;&#x2F; case-insensitive match for the string &quot;module&quot;, the script&#39;s type is
    &#x2F;&#x2F; &quot;module&quot;. ...&lt;&#x2F;spec&gt;
    return ScriptTypeAtPrepare::kModule;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kImportmap)) &#123;
    return ScriptTypeAtPrepare::kImportMap;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kSpeculationrules)) &#123;
    return ScriptTypeAtPrepare::kSpeculationRules;
  &#125;
  if (EqualIgnoringASCIICase(type, script_type_names::kWebbundle)) &#123;
    return ScriptTypeAtPrepare::kWebBundle;
  &#125;
  &#x2F;&#x2F; &lt;spec step&#x3D;&quot;8&quot;&gt;... If neither of the above conditions are true, then
  &#x2F;&#x2F; return. No script is executed.&lt;&#x2F;spec&gt;
  return ScriptTypeAtPrepare::kInvalid;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>We can see that calling <code>IsValidClassicScriptTypeAndLanguage</code> is only the first step, and there are other steps later, where other types can be passed in, which happens to be the answer to the second question.</p>
<h2><span id="question-2-types-that-ltscriptgt-can-accept">Question 2: Types that &lt;script&gt; can accept</span></h2><p>I thought about this question because there is a question called YACA in PlaidCTF 2022, which is testing this point. The official answer is here: <a target="_blank" rel="noopener" href="https://github.com/zwade/yaca/tree/master/solution">https://github.com/zwade/yaca/tree/master/solution</a></p>
<p>When I was doing this question, I completely forgot that I had done the Web Bundle question before, so I didn’t look in that direction. But anyway, from the code posted earlier, we can see that the answer to this question is the answer to the first question (those MIME types) plus the following four types:</p>
<ol>
<li>module</li>
<li>importmap</li>
<li>speculationrules</li>
<li>webbundle</li>
</ol>
<p>Module is nothing special, as mentioned earlier with webbundle. Let’s take a look at importmap and speculationrules.</p>
<p>The import map specification is here: <a target="_blank" rel="noopener" href="https://github.com/WICG/import-maps">https://github.com/WICG/import-maps</a></p>
<p>Simply put, the problem that import map wants to solve is that although browsers already support module and import, you still can’t do this in the browser:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">"moment"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> partition <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"lodash"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>You can only write a path like this:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">"/node_modules/moment/src/moment.js"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> partition <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"/node_modules/lodash-es/lodash.js"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>The solution of import map is to introduce a mapping table, so you can only use names to import:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>importmap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
  <span class="token string-property property">"imports"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"moment"</span><span class="token operator">:</span> <span class="token string">"/node_modules/moment/src/moment.js"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"lodash"</span><span class="token operator">:</span> <span class="token string">"/node_modules/lodash-es/lodash.js"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>The topic mentioned at the beginning is to use this point to replace the loaded files with a mapping table, like this:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>importmap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
  <span class="token string-property property">"imports"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
     <span class="token string-property property">"/js/ast-to-js.mjs"</span><span class="token operator">:</span> <span class="token string">"/js/eval-code.mjs"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Next, let’s take a look at speculationrules, the specification is here: <a target="_blank" rel="noopener" href="https://github.com/WICG/nav-speculation">https://github.com/WICG/nav-speculation</a></p>
<p>This feature is mainly designed to solve some problems caused by pre-rendering. I haven’t studied it in depth yet, but it looks like this:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>speculationrules<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token punctuation">&#123;</span>
  <span class="token string-property property">"prerender"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span><span class="token string-property property">"source"</span><span class="token operator">:</span> <span class="token string">"list"</span><span class="token punctuation">,</span>
     <span class="token string-property property">"urls"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"/page/2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string-property property">"score"</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token string-property property">"source"</span><span class="token operator">:</span> <span class="token string">"document"</span><span class="token punctuation">,</span>
     <span class="token string-property property">"if_href_matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://*.wikipedia.org/**"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string-property property">"if_not_selector_matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".restricted-section *"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string-property property">"score"</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>It uses JSON to specify the pre-rendering rules, which is quite different from the previous way of using <code>&lt;link rel=&quot;prerender&quot;&gt;</code>.</p>
<h2><span id="question-3">Question 3</span></h2><p>The inspiration also comes from CTF, Securinets CTF Quals 2022’s <a target="_blank" rel="noopener" href="https://ctf.zeyu2001.com/2022/securinets-ctf-quals-2022/planetsheet">PlanetSheet</a>. When the content type is <code>text/xsl</code>, you can use <code>&lt;x:script&gt;</code> to execute XSS.</p>
<p>This classic research is mentioned in every write-up: <a target="_blank" rel="noopener" href="https://github.com/BlackFan/content-type-research/blob/master/XSS.md">Content-Type Research</a>. You can click in to see the details. The following five content types can execute XSS in all browsers:</p>
<ol>
<li>text&#x2F;html</li>
<li>application&#x2F;xhtml+xml</li>
<li>application&#x2F;xml</li>
<li>text&#x2F;xml</li>
<li>image&#x2F;svg+xml</li>
</ol>
<p>I was curious and looked up Chromium’s code and found that there are two other content types that are always grouped with the others:</p>
<ol>
<li>application&#x2F;rss+xml</li>
<li>application&#x2F;atom+xml</li>
</ol>
<p>Code: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/renderer/core/loader/resource/xsl_style_sheet_resource.cc#45">xsl_style_sheet_resource.cc</a></p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">static void ApplyXSLRequestProperties(FetchParameters&amp; params) &#123;
  params.SetRequestContext(mojom::blink::RequestContextType::XSLT);
  params.SetRequestDestination(network::mojom::RequestDestination::kXslt);
  &#x2F;&#x2F; TODO(japhet): Accept: headers can be set manually on XHRs from script, in
  &#x2F;&#x2F; the browser process, and... here. The browser process can&#39;t tell the
  &#x2F;&#x2F; difference between an XSL stylesheet and a CSS stylesheet, so it assumes
  &#x2F;&#x2F; stylesheets are all CSS unless they already have an Accept: header set.
  &#x2F;&#x2F; Should we teach the browser process the difference?
  DEFINE_STATIC_LOCAL(const AtomicString, accept_xslt,
                      (&quot;text&#x2F;xml, application&#x2F;xml, application&#x2F;xhtml+xml, &quot;
                       &quot;text&#x2F;xsl, application&#x2F;rss+xml, application&#x2F;atom+xml&quot;));
  params.MutableResourceRequest().SetHTTPAccept(accept_xslt);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>However, these two are not loaded as XML, so I looked it up and found this bug: <a target="_blank" rel="noopener" href="https://bugs.chromium.org/p/chromium/issues/detail?id=104358">Issue 104358: Consider allowing more types to parse as XML</a>, which mentions this commit added in 2009: <a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src/+/b4599a15c90a853930187cc751c951beb819c02d%5E%21/#F0">commit</a>, which added the following code:</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">if (mime_type &#x3D;&#x3D; &quot;application&#x2F;rss+xml&quot; ||
    mime_type &#x3D;&#x3D; &quot;application&#x2F;atom+xml&quot;) &#123;
  &#x2F;&#x2F; Sad face.  The server told us that they wanted us to treat the response
  &#x2F;&#x2F; as RSS or Atom.  Unfortunately, we don&#39;t have a built-in feed previewer
  &#x2F;&#x2F; like other browsers.  We can&#39;t just render the content as XML because
  &#x2F;&#x2F; web sites let third parties inject arbitrary script into their RSS
  &#x2F;&#x2F; feeds.  That leaves us with little choice but to practically ignore the
  &#x2F;&#x2F; response.  In the future, when we have an RSS feed previewer, we can
  &#x2F;&#x2F; remove this logic.
  mime_type.assign(&quot;text&#x2F;plain&quot;);
  response_-&gt;response_head.mime_type.assign(mime_type);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Because RSS feeds may contain third-party content, if they are rendered directly as XML, there is a risk of XSS, so these two are forcibly turned off.</p>
<p>Finally, note a tool that can help search for source code, which is super useful: <a target="_blank" rel="noopener" href="https://sourcegraph.com/search">https://sourcegraph.com/search</a></p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/en/tags/Security/">#Security</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2022/04/24/en/how-much-do-you-know-about-script-type/">How much do you know about script type?</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2022/04/14/en/javascript-magic-of-string-and-regexp/">The Magical Features of RegExp and String Replacement in JavaScript</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">Comments</h3>
    <script src="https://utteranc.es/client.js"
        repo="aszx87410/huli-blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>English</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            <!-- NOTE: 永遠回到首頁 -->
            
                <a href="/2022/04/24/script-type/" class="dropdown-item">
                    繁體中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>



    
    
    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js?v=3.js"></script>


    
</body>
</html>