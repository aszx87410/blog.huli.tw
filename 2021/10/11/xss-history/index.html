<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="zh-tw">
<head>
    <meta charset="utf-8">
<title>XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾† - Huli&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-adsense-account" content="ca-pub-1121865251398741">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1121865251398741"
     crossorigin="anonymous"></script>


            
<link href="https://blog.huli.tw/2021/10/11/en/xss-history/" rel="alternate" hreflang="en" />
            
    




    
<link rel="canonical" href="https://blog.huli.tw/2021/10/11/xss-history/">
    





    <meta name="description" content="æˆ‘ä»¥å‰æœ‰å¯«éä¸€äº›é—œæ–¼ XSS çš„æ–‡ç« ï¼Œä¸»è¦åœ¨è«‡çš„æ˜¯å¯¦ä½œé¢çš„é˜²ç¯„ä»¥åŠé˜²ç¦¦çš„å„å€‹ç´°ç¯€ï¼š  é˜²æ­¢ XSS å¯èƒ½æ¯”æƒ³åƒä¸­å›°é›£ æ·ºè«‡ XSS æ”»æ“Šèˆ‡é˜²ç¦¦çš„å„å€‹ç’°ç¯€  é€™ç¯‡åŸæœ¬æƒ³å¯«çš„æ˜¯ XSS çš„åŸºç¤ï¼Œå°±å¤§å®¶éƒ½è½éçš„é‚£ä¸‰ç¨®é¡åˆ¥ï¼šStored(Persistent)ã€Reflected(Non-Persistent) ä»¥åŠ DOM-based XSSï¼Œä½†ç•¶æˆ‘æ­£è¦é–‹å§‹å¯«çš„æ™‚å€™ï¼Œè…¦ä¸­çªç„¶æµ®ç¾äº†å¹¾å€‹å•é¡Œï¼šã€ŒXSS æ˜¯">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†">
<meta property="og:url" content="https://blog.huli.tw/2021/10/11/xss-history/index.html">
<meta property="og:site_name" content="Huli&#39;s blog">
<meta property="og:description" content="æˆ‘ä»¥å‰æœ‰å¯«éä¸€äº›é—œæ–¼ XSS çš„æ–‡ç« ï¼Œä¸»è¦åœ¨è«‡çš„æ˜¯å¯¦ä½œé¢çš„é˜²ç¯„ä»¥åŠé˜²ç¦¦çš„å„å€‹ç´°ç¯€ï¼š  é˜²æ­¢ XSS å¯èƒ½æ¯”æƒ³åƒä¸­å›°é›£ æ·ºè«‡ XSS æ”»æ“Šèˆ‡é˜²ç¦¦çš„å„å€‹ç’°ç¯€  é€™ç¯‡åŸæœ¬æƒ³å¯«çš„æ˜¯ XSS çš„åŸºç¤ï¼Œå°±å¤§å®¶éƒ½è½éçš„é‚£ä¸‰ç¨®é¡åˆ¥ï¼šStored(Persistent)ã€Reflected(Non-Persistent) ä»¥åŠ DOM-based XSSï¼Œä½†ç•¶æˆ‘æ­£è¦é–‹å§‹å¯«çš„æ™‚å€™ï¼Œè…¦ä¸­çªç„¶æµ®ç¾äº†å¹¾å€‹å•é¡Œï¼šã€ŒXSS æ˜¯">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://blog.huli.tw/img/xss-history/xss-10years.png">
<meta property="article:published_time" content="2021-10-10T16:00:00.000Z">
<meta property="article:modified_time" content="2023-05-07T01:15:16.493Z">
<meta property="article:author" content="Huli">
<meta property="article:tag" content="Front-end">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.huli.tw/img/xss-history/xss-10years.png">



<link rel="alternative" href="/atom.xml" title="XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†" type="application/atom+xml">



<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">


<link rel="stylesheet" href="/css/bulma.css?v=2.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />


<link rel="stylesheet" href="/css/style.css?v=4.css">





    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1393J2EVCZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1393J2EVCZ');
</script>


    


<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <script>
        if (localStorage.getItem('dark-mode')) {
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode')
            }
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode')
            }
        }
    </script>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    Huli&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">æ–‡ç« åˆ—è¡¨</a>
            
            <a class="navbar-item "
               href="/categories">åˆ†é¡</a>
            
            <a class="navbar-item "
               href="/recommend">æ¨è–¦é–±è®€</a>
            
            <a class="navbar-item "
               href="/about">é—œæ–¼æˆ‘</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="ç›®éŒ„">
                    ç›®éŒ„
                </a>
                <div class="navbar-dropdown">
                    
                    
                    
                    
                    <a class="navbar-item" href="#xss-çš„èª•ç”Ÿ">1&nbsp;&nbsp;<b>XSS çš„èª•ç”Ÿ</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#ç¬¬ä¸‰ç¨®-xss-åˆ†é¡çš„èª•ç”Ÿ">2&nbsp;&nbsp;<b>ç¬¬ä¸‰ç¨® XSS åˆ†é¡çš„èª•ç”Ÿ</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#çµèª">3&nbsp;&nbsp;<b>çµèª</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" target="_blank" title="Medium" href="https://hulitw.medium.com/">
                
                <i class="fab fa-medium"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="Facebook" href="https://www.facebook.com/huli.blog">
                
                <i class="fab fa-facebook"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="RSS" href="/atom-ch.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
               
            
            <a class="navbar-item btn-dark-mode" title="dark-mode" href="#">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15" height="15" viewBox="0 0 256 256" xml:space="preserve">
                    <defs>
                    </defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >
                        <path d="M 87.823 60.7 c -0.463 -0.423 -1.142 -0.506 -1.695 -0.214 c -15.834 8.398 -35.266 2.812 -44.232 -12.718 c -8.966 -15.53 -4.09 -35.149 11.101 -44.665 c 0.531 -0.332 0.796 -0.963 0.661 -1.574 c -0.134 -0.612 -0.638 -1.074 -1.259 -1.153 c -9.843 -1.265 -19.59 0.692 -28.193 5.66 C 13.8 12.041 6.356 21.743 3.246 33.35 S 1.732 57.08 7.741 67.487 c 6.008 10.407 15.709 17.851 27.316 20.961 C 38.933 89.486 42.866 90 46.774 90 c 7.795 0 15.489 -2.044 22.42 -6.046 c 8.601 -4.966 15.171 -12.43 18.997 -21.586 C 88.433 61.79 88.285 61.123 87.823 60.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: #ffa716; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                    </g>
                    </svg>
                </div>
            </a>
            
                <a class="navbar-item" href="/2021/10/11/en/xss-history/">English</a>
            
            

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
      
      <div data-nosnippet class="self-notice">
        æœ€è¿‘é–‹äº†ä¸€å€‹è®€è€…å›é¥‹è¡¨å–®ï¼Œç„¡è«–æ˜¯å°æ–‡ç« çš„æ„Ÿæƒ³æˆ–æ˜¯å°éƒ¨è½æ ¼çš„æ„Ÿæƒ³ï¼Œæœ‰ä»€éº¼æƒ³å›é¥‹çš„éƒ½å¯ä»¥å¡«è¡¨å–®è·Ÿæˆ‘èªªï¼š<a href="https://forms.gle/XuWyRC5qtSd2ANta8" target="_blank">è¡¨å–®é€£çµ</a>
      </div>
      
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2021-10-10T16:00:00.000Z" itemprop="datePublished">2021å¹´10æœˆ11æ—¥</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/Security/">Security</a>
        </span>
        
        
        
    </div>
    
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>æˆ‘ä»¥å‰æœ‰å¯«éä¸€äº›é—œæ–¼ XSS çš„æ–‡ç« ï¼Œä¸»è¦åœ¨è«‡çš„æ˜¯å¯¦ä½œé¢çš„é˜²ç¯„ä»¥åŠé˜²ç¦¦çš„å„å€‹ç´°ç¯€ï¼š</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://tech-blog.cymetrics.io/posts/huli/prevent-xss-might-be-harder-than-you-thought/">é˜²æ­¢ XSS å¯èƒ½æ¯”æƒ³åƒä¸­å›°é›£</a></li>
<li><a target="_blank" rel="noopener" href="https://tech-blog.cymetrics.io/posts/huli/xss-attack-and-defense/">æ·ºè«‡ XSS æ”»æ“Šèˆ‡é˜²ç¦¦çš„å„å€‹ç’°ç¯€</a></li>
</ol>
<p>é€™ç¯‡åŸæœ¬æƒ³å¯«çš„æ˜¯ XSS çš„åŸºç¤ï¼Œå°±å¤§å®¶éƒ½è½éçš„é‚£ä¸‰ç¨®é¡åˆ¥ï¼šStored(Persistent)ã€Reflected(Non-Persistent) ä»¥åŠ DOM-based XSSï¼Œä½†ç•¶æˆ‘æ­£è¦é–‹å§‹å¯«çš„æ™‚å€™ï¼Œè…¦ä¸­çªç„¶æµ®ç¾äº†å¹¾å€‹å•é¡Œï¼šã€ŒXSS æ˜¯ä»€éº¼æ™‚å€™å‡ºç¾çš„ï¼Ÿé€™ä¸‰ç¨®é¡åˆ¥åˆæ˜¯ä»€éº¼æ™‚å€™é–‹å§‹è¢«åˆ†é¡çš„ï¼Ÿã€</p>
<p>å› æ­¤ï¼Œæˆ‘èŠ±äº†é»æ™‚é–“æ‰¾äº†ä¸€äº›è³‡æ–™ï¼Œé€™ç¯‡æ–‡ç« æœƒè·Ÿå¤§å®¶è«‡è«‡ XSS çš„æ­·å²ï¼Œè®“æˆ‘å€‘ä¸€èµ·æ›´äº†è§£ XSS çš„å‰ä¸–ä»Šç”Ÿã€‚</p>
<span id="more"></span>


<h2><span id="xss-çš„èª•ç”Ÿ">XSS çš„èª•ç”Ÿ</span></h2><p>å¾å¾®è»Ÿçš„ MSDN blog åœ¨ 2009 å¹´ 12 æœˆç™¼ä½ˆçš„æ–‡ç« æ¨™é¡Œï¼š<a target="_blank" rel="noopener" href="https://web.archive.org/web/20100723152801/http://blogs.msdn.com/b/dross/archive/2009/12/15/happy-10th-birthday-cross-site-scripting.aspx">Happy 10th birthday Cross-Site Scripting!</a> ä¸­å°±å¯ä»¥çœ‹å‡º XSSï¼ˆCross-Site Scriptingï¼‰é€™å€‹åè©ç´„è«æ˜¯ 1999 å¹´ 12 æœˆèª•ç”Ÿçš„ï¼Œé›¢ç¾åœ¨å·²ç¶“ 20 å¹¾å¹´äº†ã€‚</p>
<p>ï¼ˆä¸‹åœ–ç‚ºä¸Šé¢é€£çµçš„æˆªåœ–ï¼‰</p>
<p><img src="/img/xss-history/xss-10years.png" alt="xss-history"></p>
<p>åŸæ–‡æœ€å¾Œæœ‰é€™éº¼ä¸€æ®µè©±ï¼š</p>
<blockquote>
<p>Letâ€™s hope that ten years from now weâ€™ll be celebrating the death, not the birth, of Cross-Site Scripting!</p>
</blockquote>
<p>å¾ˆéºæ†¾çš„ï¼Œ2009 å¹´çš„ 10 å¹´å¾Œï¼Œä¹Ÿå°±æ˜¯ 2019 å¹´ï¼ŒXSS ä¾èˆŠæŒçºŒæ´»èºè‘—ï¼Œåœ¨ 2017 å¹´çš„ OWASP top 10 æ’åœ¨ç¬¬ä¸ƒåï¼Œ2021 çš„ç‰ˆæœ¬å‰‡ä½µå…¥ç¬¬ä¸‰å Injection çš„é¡åˆ¥ã€‚</p>
<p>è€Œæ–‡ä¸­æåˆ°çš„ï¼š<a target="_blank" rel="noopener" href="https://web.archive.org/web/20100516115740/http://www.cert.org/advisories/CA-2000-02.html">CERTÂ® Advisory CA-2000-02 Malicious HTML Tags Embedded in Client Web Requests</a>ï¼Œå¯ä»¥è®“æˆ‘å€‘ä¸€çªºæœ€æ—©æœŸ XSS çš„é¢è²Œã€‚åº•ä¸‹å°±è®“æˆ‘å€‘ç°¡å–®çœ‹ä¸€ä¸‹é€™å€‹ç¶²é çš„å…§å®¹ï¼š</p>
<blockquote>
<p>A web site may inadvertently include malicious HTML tags or script in a dynamically generated page based on unvalidated input from untrustworthy sources. This can be a problem when a web server does not adequately ensure that generated pages are properly encoded to prevent unintended execution of scripts, and when input is not validated to prevent malicious HTML from being presented to the user.</p>
</blockquote>
<p>åœ¨ Overview çš„éƒ¨åˆ†å…¶å¯¦å°±æŠŠ XSS çš„æ ¸å¿ƒæ¦‚å¿µè¬›å¾—éå¸¸æ¸…æ¥šäº†ï¼Œserver æ²’æœ‰é©—è­‰è¼¸å…¥æˆ–æ˜¯ç·¨ç¢¼ï¼Œå°è‡´æ”»æ“Šè€…å¯ä»¥æ’å…¥ä¸€äº›æƒ¡æ„çš„ HTML æ¨™ç±¤æˆ–æ˜¯ scriptã€‚</p>
<blockquote>
<p>Malicious code provided by one client for another client</p>
<p>Sites that host discussion groups with web interfaces have long guarded against a vulnerability where one client embeds malicious HTML tags in a message intended for another client. For example, an attacker might post a message like <code>Hello message board. This is a message.&lt;SCRIPT&gt;malicious code&lt;/SCRIPT&gt;This is the end of my message.</code></p>
<p>When a victim with scripts enabled in their browser reads this message, the malicious code may be executed unexpectedly. Scripting tags that can be embedded in this way include <code>&lt;SCRIPT</code>&gt; <code>&lt;OBJECT&gt;</code>, <code>&lt;APPLET&gt;</code>, and <code>&lt;EMBED&gt;</code>.</p>
<p>When client-to-client communications are mediated by a server, site developers explicitly recognize that data input is untrustworthy when it is presented to other users. Most discussion group servers either will not accept such input or will encode&#x2F;filter it before sending anything to other readers.</p>
</blockquote>
<p>é€™ä¸€æ®µå‰‡æ˜¯å¾Œä¾†è¢«ç¨±ç‚ºã€ŒStored XSSï¼ˆä¹Ÿç¨±ç‚º Persistent XSSï¼‰ã€çš„åˆ†é¡ï¼Œå‡è¨­æœ‰ä¸€å€‹è¨è«–å€å¯ä»¥è®“äººç•™è¨€ï¼Œä¸€å€‹æƒ¡æ„çš„æ”»æ“Šè€…å¯ä»¥ç•™é€™æ¨£çš„å…§å®¹ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">Hello message board. This is a message.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SCRIPT</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">malicious code</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SCRIPT</span><span class="token punctuation">></span></span>
This is the end of my message.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç•¶å…¶ä»–ä½¿ç”¨è€…çœ‹åˆ°é€™ç¯‡ç•™è¨€çš„æ™‚å€™ï¼Œå› ç‚ºç•™è¨€è£¡é¢æœ‰ <code>&lt;script&gt;</code> ï¼Œæ‰€ä»¥å°±æœƒåŸ·è¡Œæ”»æ“Šè€…æ‰€ç•™ä¸‹çš„ JavaScript ç¨‹å¼ç¢¼ã€‚</p>
<p>é™¤äº†é€™å€‹ä»¥å¤–ï¼Œ<code>&lt;object&gt;</code>ã€<code>&lt;applet&gt;</code> è·Ÿ <code>&lt;embed&gt;</code> ä¹Ÿéƒ½å¯ä»¥ç”¨ä¾†åŸ·è¡Œ JavaScriptï¼ˆè©±èªª applet é€™æ¨™ç±¤æ‡‰è©²å·²ç¶“æ²’ç”¨äº†ï¼Œå¯åƒè€ƒï¼š<a href="https://blog.huli.tw/2019/11/26/dont-break-web-smooshgate-and-keygen/">Donâ€™t break the Webï¼šä»¥ SmooshGate ä»¥åŠ keygen ç‚ºä¾‹ </a>ï¼‰ã€‚</p>
<blockquote>
<p>Malicious code sent inadvertently by a client for itself</p>
<p>Many Internet web sites overlook the possibility that a client may send malicious data intended to be used only by itself. This is an easy mistake to make. After all, why would a user enter malicious code that only the user will see?</p>
<p>However, this situation may occur when the client relies on an untrustworthy source of information when submitting a request. For example, an attacker may construct a malicious link such as <code>&lt;A HREF=&quot;http://example.com/comment.cgi? mycomment=&lt;SCRIPT&gt;malicious code&lt;/SCRIPT&gt;&quot;&gt; Click here&lt;/A&gt;</code></p>
<p>When an unsuspecting user clicks on this link, the URL sent to example.co includes the malicious code. If the web server sends a page back to the user including the value of mycomment, the malicious code may be executed unexpectedly on the client. This example also applies to untrusted links followed in email or newsgroup messages.</p>
</blockquote>
<p>é€™ä¸€æ®µå°±å¾ˆæœ‰è¶£äº†ï¼Œæ¨™é¡Œæ˜¯ï¼šã€ŒMalicious code sent inadvertently by a client for itselfã€ï¼Œç™¼é€çš„å…§å®¹åŸºæœ¬ä¸Šåªæœ‰è‡ªå·±èƒ½çœ‹åˆ°ã€‚</p>
<p>ä¾‹å¦‚èªªç¶²å€ä¸­ mycomment é€™å€‹åƒæ•¸æœƒåæ˜ åˆ°ç•«é¢ä¸Šï¼Œæ‰€ä»¥åƒæ˜¯ <code>http://example.com/comment.cgi?mycomment=123</code>ï¼Œç•«é¢ä¸Šé¢å°±æœƒå‡ºç¾ 123ã€‚</p>
<p>ä½†åªæœ‰è‡ªå·±èƒ½çœ‹åˆ°èƒ½åšä»€éº¼å‘¢ï¼Ÿ</p>
<p>å› ç‚ºæ˜¯é€éç¶²å€ä¸Šçš„ query string ä¾†å‚³éè³‡è¨Šï¼Œå› æ­¤å¯ä»¥ç”¢ç”Ÿé€™æ¨£çš„ä¸€å€‹é€£çµï¼š<code>http://example.com/comment.cgi?mycomment=&lt;SCRIPT&gt;malicious code&lt;/SCRIPT&gt;</code>ï¼Œæ¥è‘—å†æŠŠé€™å€‹é€£çµå‚³çµ¦å…¶ä»–äººï¼Œç•¶å…¶ä»–äººé»äº†ä»¥å¾Œï¼Œç•«é¢ä¸Šå°±æœƒå‡ºç¾ <code>&lt;SCRIPT&gt;malicious code&lt;/SCRIPT&gt;</code>ï¼Œç…§æ¨£é”æˆ XSSã€‚</p>
<p>é€™å°±æ˜¯ XSS çš„å¦å¤–ä¸€ç¨®åˆ†é¡ï¼šReflected XSSï¼Œä½ çš„è¼¸å…¥æœƒåæ˜ åœ¨ç•«é¢ä¸Šã€‚</p>
<p>è€Œé€™å…©ç¨®çš„å·®åˆ¥åœ¨æ–¼ Stored XSS å°±åƒå®ƒçš„åå­—ä¸€æ¨£ï¼ŒXSS payload æ˜¯è¢«ä¿å­˜ä½çš„ï¼Œä»¥è¨è«–å€ä¾†èªªï¼Œæ–‡ç« æ˜¯ä¿å­˜åœ¨è³‡æ–™åº«ä¸­çš„ï¼Œè€Œ Reflected XSS å‰‡ä¸ç„¶ã€‚</p>
<p>ä»¥ PHP ç‚ºä¾‹ï¼ŒReflected XSS çš„ç¨‹å¼ç¢¼å¯èƒ½æœƒåƒé€™æ¨£ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
   <span class="token variable">$comment</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'comment'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?=</span> <span class="token variable">$comment</span> <span class="token delimiter important">?></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŠŠ GET çš„åƒæ•¸ç›´æ¥åæ˜ åœ¨ç•«é¢ä¸Šï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡éƒ½å¿…é ˆé€é comment é€™å€‹åƒæ•¸æŠŠ payload å‚³é€²å»ï¼Œå¦å‰‡ä¸æœƒè§¸ç™¼ XSSã€‚</p>
<p>ä»¥ä¸Šé¢æçš„ã€Œè¨è«–å€ã€é€™å€‹ç¶²ç«™ç‚ºä¾‹ï¼ŒStored XSS çš„ç ´å£åŠ›æ‡‰è©²æ˜¯æ›´å¼·å¤§çš„ï¼Œå› ç‚ºåªè¦é»é€²å»ä½ é€™ç¯‡æ–‡ç« å°±æœƒä¸­æ‹›ï¼Œå¯ä»¥æƒ³æˆä½ åœ¨ ptt ç™¼äº†ä¸€ç¯‡æ–‡ç« ï¼Œåªè¦æœ‰é„‰æ°‘é»é€²ä¾†æ–‡ç« å°±æœƒè¢«æ”»æ“Šï¼Œé‚„æ»¿å®¹æ˜“è§¸ç™¼çš„ã€‚</p>
<p>ä½† Reflected XSS å°±ä¸å¤ªä¸€æ¨£äº†ï¼Œé€™éœ€è¦ä½¿ç”¨è€…é»æ“Šé€£çµæ‰æœƒå‡ºäº‹ï¼Œåƒæ˜¯ä½ åœ¨ ptt æ¨æ–‡ç•™äº†ä¸€å€‹é€£çµï¼Œé„‰æ°‘è¦ä¸»å‹•é»é‚£å€‹é€£çµæ‰èƒ½è§¸ç™¼ XSSã€‚</p>
<p>æ–‡ä¸­çš„å…¶ä»–éƒ¨åˆ†ä¹Ÿå¾ˆæœ‰è¶£ï¼Œä¾‹å¦‚èªªä¹Ÿæœ‰æåˆ°åƒ…ç®¡æŠŠ JavaScript disabledï¼Œä¾ç„¶å¯ä»¥ç”¨ HTML èˆ‡ CSS å»ç«„æ”¹ç•«é¢ç­‰ç­‰ï¼Œä¹Ÿæœ‰æåˆ°ä¿®è£œæ–¹å¼ï¼Œåœ¨é€™é‚Šï¼š<a target="_blank" rel="noopener" href="https://web.archive.org/web/20100527204457/http://www.cert.org/tech_tips/malicious_code_mitigation.html">Understanding Malicious Content Mitigation for Web Developers</a></p>
<p>ä¿®è£œæ–¹å¼é™¤äº†æˆ‘å€‘ç†Ÿæ‚‰çš„é‡å°å…§å®¹ç·¨ç¢¼ä»¥å¤–ï¼Œé‚„æœ‰å¦ä¸€å€‹æ˜¯è¦ã€ŒæŒ‡å®šç·¨ç¢¼æ–¹å¼ã€ï¼Œé€™é‚Šçš„ç·¨ç¢¼æŒ‡çš„æ˜¯ UTF-8 æˆ–æ˜¯ ISO-8859-1 ä»¥åŠ big5 é€™ç¨®ç·¨ç¢¼ã€‚é›–ç„¶èªªç¾åœ¨é€™å€‹å¹´ä»£çµ•å¤§éƒ¨åˆ†ç¶²ç«™éƒ½æ˜¯ UTF-8 äº†ï¼Œä½†æ—©æœŸå…¶å¯¦ä¸ç„¶ã€‚åœ¨ä»¥å¾€ç€è¦½å™¨é‚„æ”¯æ´åƒæ˜¯ UTF-7 é€™æ¨£çš„ç·¨ç¢¼æ–¹å¼ï¼Œå°±ç®—ä¸ç”¨ä¸€äº›ç‰¹æ®Šå­—å…ƒä¹Ÿå¯ä»¥é”æˆ XSSï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>test page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  +ADw-script+AD4-alert(1)+ADw-/script+AD4-
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¯„ä¾‹å–è‡ªï¼š<a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/XSS%E5%92%8C%E5%AD%97%E7%AC%A6%E9%9B%86%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF.html">XSS å’Œå­—ç¬¦é›†çš„é‚£äº›äº‹å…’</a>ï¼Œè£¡é¢æœ‰æåˆ°æ›´å¤šé€™ç¨®é¡ä¼¼çš„å•é¡Œï¼Œä½†å¤§å¤šæ•¸å•é¡Œæ‡‰è©²éƒ½ç™¼ç”Ÿåœ¨æ¯”è¼ƒæ—©æœŸçš„ç€è¦½å™¨ä¸Šé¢ã€‚</p>
<h2><span id="ç¬¬ä¸‰ç¨®-xss-åˆ†é¡çš„èª•ç”Ÿ">ç¬¬ä¸‰ç¨® XSS åˆ†é¡çš„èª•ç”Ÿ</span></h2><p>æœ‰çœ‹é XSS æ–‡ç« çš„äººéƒ½çŸ¥é“ï¼Œæœ€å»£ç‚ºäººçŸ¥çš„ XSS åˆ†é¡å¤§æ¦‚å°±ä¸‰ç¨®ï¼š</p>
<ol>
<li>Stored XSSï¼ˆPersistent XSSï¼‰</li>
<li>Reflected XSSï¼ˆNon-Persistent XSSï¼‰</li>
<li>DOM-based XSS</li>
</ol>
<p>å†ç¹¼çºŒå¾€ä¸‹ä¹‹å‰ï¼Œæˆ‘å…ˆä¾†å•å•çœ‹å¤§å®¶å…©å€‹å•é¡Œã€‚</p>
<p>ç¬¬ä¸€å€‹å•é¡Œï¼Œå‡è¨­ç¾åœ¨æˆ‘ç™¼äº†ä¸€ç¯‡æ–‡ç« ï¼Œå…§å®¹ç‚º <code>&lt;img src=x onerror=alert(1)&gt;</code>ï¼Œè€Œé¡¯ç¤ºæ–‡ç« çš„é é¢ç¨‹å¼ç¢¼æ˜¯é€™æ¨£çš„ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token function">getPost</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">post</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.article'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> post<span class="token punctuation">.</span>content
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ç‚ºç”¨äº† innerHTML çš„ç·£æ•…ï¼Œæ‰€ä»¥å°±æœ‰äº†ä¸€å€‹ XSS æ¼æ´ï¼Œåœ¨é€™å€‹ç‹€æ³ä¹‹ä¸‹ï¼Œæˆ‘çš„ç•™è¨€ç¢ºå¯¦æœ‰ã€Œä¿å­˜ã€åœ¨è³‡æ–™åº«ï¼Œä½†ä¹ŸåŒæ™‚ç”¨äº† DOM å»æ”¹è®Šå…§å®¹ï¼Œé‚£é€™å€‹ XSS æ‡‰è©²è¢«æ­¸é¡åœ¨ Stored XSSï¼Œé‚„æ˜¯ DOM-based XSSï¼Ÿ</p>
<p>ç¬¬äºŒå€‹å•é¡Œï¼Œå‡è¨­ç¶²é ä¸­æœ‰ä¸€æ®µç¨‹å¼ç¢¼é•·é€™æ¨£ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".search"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>é€™é¡¯ç„¶å¯ä»¥é€é query string è£½é€ å‡ºä¸€å€‹ XSS æ¼æ´ï¼Œé€™å€‹ XSS ç¢ºå¯¦åæ˜ äº†ä½¿ç”¨è€…çš„è¼¸å…¥ï¼Œè€Œä¸”æ²’æœ‰è¢«å„²å­˜åœ¨è³‡æ–™åº«è£¡é¢ï¼Œä¸éå»æ˜¯ç”¨ DOM å»æ”¹è®Šå…§å®¹ï¼Œé‚£å®ƒæ‡‰è©²æ˜¯ Reflected XSSï¼Œé‚„æ˜¯ DOM-based XSSï¼Ÿ</p>
<p>åœ¨ç¹¼çºŒå¾€ä¸‹é–±è®€ä¹‹å‰ï¼Œå¤§å®¶å¯ä»¥å…ˆæƒ³ä¸€ä¸‹ä¸Šé¢é€™å…©å€‹å•é¡Œã€‚</p>
<p>å…ˆä¾†è¬›è¬›æˆ‘ä»¥å‰çš„ç­”æ¡ˆï¼Œæˆ‘ä¹‹å‰æ˜¯ç”¨ä¸‹é¢çš„å®šç¾©ä¾†åˆ†é¡é€™å¹¾å€‹çš„ï¼š</p>
<ol>
<li>æˆ‘çš„ XSS payloadï¼ˆä¾‹å¦‚èªª <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>ï¼‰å¦‚æœæœ‰å­˜åœ¨è³‡æ–™åº«ï¼Œé‚£å°±æ˜¯ Stored XSS</li>
<li>å¦‚æœä¸æ˜¯ï¼Œé‚£å°±çœ‹æˆ‘çš„ payload æ˜¯ç›´æ¥å¾å¾Œç«¯è¼¸å‡ºï¼Œé‚„æ˜¯é€é DOM å»è³¦å€¼ï¼Œå‰è€…å°±æ˜¯ Reflectedï¼Œå¾Œè€…å°±æ˜¯ DOM-based</li>
</ol>
<p>å¾Œä¾†æˆ‘æ‰ç™¼ç¾é€™å€‹åˆ†é¡æ–¹å¼æ˜¯éŒ¯èª¤çš„ï¼Œå› ç‚ºæˆ‘è¢«ã€Œstoredã€é€™å€‹åè©èª¤å°äº†ï¼Œæ²’æœ‰æ„è­˜åˆ°é€™èƒŒå¾Œçš„æ­·å²èƒŒæ™¯ã€‚</p>
<p>é€™æ˜¯ä»€éº¼æ„æ€å‘¢ï¼Ÿåœ¨ 1999 å¹´ XSS å‰›å‡ºä¾†çš„æ™‚å€™ï¼ŒAjax é‚„ä¸å­˜åœ¨ï¼ˆå®ƒæ˜¯ 2005 å¹´æ‰èª•ç”Ÿçš„ï¼‰ï¼Œæ‰€ä»¥å‰å¾Œç«¯çš„è³‡æ–™äº¤æ›æ‡‰è©²éƒ½æ˜¯é€éè¡¨å–®é€å» Serverï¼Œä¸¦ä¸”ç›´æ¥æŠŠå›æ‡‰ render å‡ºä¾†ã€‚</p>
<p>æ›å¥è©±èªªï¼Œåœ¨ 1999 å¹´çš„æ™‚å€™ï¼ŒåŸºæœ¬ä¸Šæ²’æœ‰ä»€éº¼æ“ä½œæ˜¯ç”¨ JavaScript å»æ›´æ”¹ç•«é¢å…§å®¹çš„ï¼Œå°±ç®—æœ‰ï¼Œä¹Ÿæ˜¯ä¸€äº›æ¯”è¼ƒç„¡é—œç·Šè¦çš„æ“ä½œã€‚ä½†åœ¨ 2021 å¹´éƒ½ä¸ä¸€æ¨£äº†ï¼Œåœ¨é€™å€‹ SPA ç››è¡Œçš„å¹´ä»£ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯é€é JavaScript å»å‘¼å« APIï¼Œæ‹¿åˆ°è³‡æ–™ä»¥å¾Œå†å»æ›´æ”¹ç•«é¢ï¼Œå¾Œç«¯åªè² è²¬æä¾›è³‡æ–™ï¼Œå‰ç«¯é è‘— JavaScript ä¾† renderï¼Œé€™è·Ÿ 20 å¹´å‰å®Œå…¨ä¸åŒã€‚</p>
<p>XSS çš„ä¸‰ç¨®åˆ†é¡ä¹‹ä¸­ï¼Œå‰å…©ç¨® Stored ä»¥åŠ Reflected åœ¨ XSS èª•ç”Ÿä¹‹æ™‚å°±å·²ç¶“å­˜åœ¨äº†ï¼Œè€Œç¬¬ä¸‰ç¨®å‰‡æ™šäº†äº”å¹´æ‰å‡ºç¾ï¼ˆé€™é‚Šçš„ã€Œå‡ºç¾ã€æŒ‡çš„æ˜¯æœ‰å€‹åè©æˆ–åˆ†é¡ä¾†å®šç¾©å®ƒï¼Œè€Œä¸æ˜¯æŒ‡æ”»æ“Šå‡ºç¾ï¼‰ï¼Œå‡ºè™•æ‡‰è©²æ˜¯é€™ä¸€ç¯‡ï¼š<a target="_blank" rel="noopener" href="http://www.webappsec.org/projects/articles/071105.shtml">DOM Based Cross Site Scripting or XSS of the Third Kind</a></p>
<p>æ–‡ä¸­çš„ Introduction æœ‰é€™æ¨£ä¸€å€‹æ®µè½ï¼š</p>
<blockquote>
<p> XSS is typically categorized into â€œnon-persistentâ€ and â€œpersistentâ€ (â€œreflectedâ€ and â€œstoredâ€ accordingly, as defined in [4]). â€œNon-persistentâ€ means that the malicious (Javascript) payload is echoed by the server in an immediate response to an HTTP request from the victim. â€œPersistentâ€ means that the payload is stored by the system, and may later be embedded by the vulnerable system in an HTML page provided to a victim.</p>
</blockquote>
<p>é‡é»æ˜¯ Stored è·Ÿ Reflected é€™å…©å€‹åˆ†é¡éƒ½æœ‰ä¸€å€‹å‰æï¼šã€Œpayload æ˜¯ç”±å¾Œç«¯ç›´æ¥ render çš„ã€ï¼Œè€Œé€™ç¯‡æ–‡ç« æ‰€æåˆ°çš„ç¬¬ä¸‰å€‹åˆ†é¡ DOM-basedï¼ŒæŒ‡çš„å‰‡æ˜¯ã€Œpayload æ˜¯ç”±å‰ç«¯ render å‡ºä¾†çš„ã€ï¼Œé€™å°±æ˜¯ç¬¬ä¸‰ç¨®èˆ‡å‰å…©ç¨®çš„æœ€å¤§å·®ç•°ã€‚</p>
<p>åœ¨åˆ¤åˆ¥ XSS çš„æ™‚å€™ï¼Œæ‡‰è©²å…ˆç¢ºèªçš„å…¶å¯¦æ˜¯ã€Œpayload æ˜¯å‰ç«¯é‚„æ˜¯å¾Œç«¯ renderï¼Ÿã€ï¼Œå¦‚æœæ˜¯å‰ç«¯ render å‡ºä¾†ï¼Œä¸è«–è³‡æ–™å¾å“ªè£¡ä¾†ï¼ˆå¾è³‡æ–™åº«æˆ–æ˜¯ç¶²å€æˆ–ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ï¼‰ï¼Œå°±æ˜¯ DOM-based XSSã€‚å¦‚æœæ˜¯å¾Œç«¯ render å‡ºä¾†ï¼Œæ‰å»å€åˆ†æ˜¯ Stored é‚„æ˜¯ Reflectedã€‚</p>
<p>å› æ­¤ï¼Œå‰›å‰›é‚£å…©å€‹å•é¡Œå› ç‚ºéƒ½æ˜¯å‰ç«¯ render çš„é—œä¿‚ï¼Œéƒ½æœƒè¢«æ­¸é¡åœ¨ DOM-based XSSã€‚</p>
<p>ä¸Šé¢çš„æ–‡ç« ä¸­å°±æœ‰èˆ‰ä¸€å€‹é¡ä¼¼çš„ä¾‹å­ï¼š</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HTML</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TITLE</span><span class="token punctuation">></span></span>Welcome!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TITLE</span><span class="token punctuation">></span></span>
Hi
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SCRIPT</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">var</span> pos<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"name="</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SCRIPT</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BR</span><span class="token punctuation">></span></span>
Welcome to our system
â€¦
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HTML</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨æ–‡ç« çš„è¨»è§£ä¸­é‚„ç‰¹åˆ¥æåˆ°äº†ï¼š</p>
<blockquote>
<p>The malicious payload was not embedded in the raw HTML page at any time (unlike the other flavors of XSS).</p>
</blockquote>
<p>å› ç‚º payload å…¶å¯¦ä¸å­˜åœ¨æ–¼ä»»ä½• HTML pageï¼ˆå› ç‚ºæ˜¯å¾Œä¾†æ‰ç”¨ JavaScript æ”¹è®Šçš„ï¼‰ï¼Œæ‰€ä»¥å®ƒä¸å±¬æ–¼ Stored ä¹Ÿä¸å±¬æ–¼ Reflectedï¼Œæ˜¯ç¬¬ä¸‰ç¨®æ–°çš„é¡å‹çš„ XSSã€‚</p>
<p>è‡³æ–¼ä¿®è£œæ–¹å¼çš„è©±ï¼Œç”±æ–¼æ˜¯åœ¨å‰ç«¯ç”¨ JavaScript renderï¼Œæ‰€ä»¥ç·¨ç¢¼çš„å·¥ä½œç•¶ç„¶å°±æ˜¯å‰ç«¯çš„é–‹ç™¼è€…è¦è² è²¬ï¼Œä¸€å€‹å¸¸è¦‹çš„æ–¹å¼æ˜¯é€™æ¨£ï¼ˆç¨‹å¼ç¢¼å–è‡ªï¼š<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2794137/sanitizing-user-input-before-adding-it-to-the-dom-in-javascript">Sanitizing user input before adding it to the DOM in Javascript</a>ï¼‰ï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">sanitize</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
      <span class="token string-property property">'&amp;'</span><span class="token operator">:</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'&lt;'</span><span class="token operator">:</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'>'</span><span class="token operator">:</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'"'</span><span class="token operator">:</span> <span class="token string">'&amp;quot;'</span><span class="token punctuation">,</span>
      <span class="token string-property property">"'"</span><span class="token operator">:</span> <span class="token string">'&amp;#x27;'</span><span class="token punctuation">,</span>
      <span class="token string-property property">"/"</span><span class="token operator">:</span> <span class="token string">'&amp;#x2F;'</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[&amp;&lt;>"'/]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">ig</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">match</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>match<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æœ‰ä¸€é»è¦ç‰¹åˆ¥æ³¨æ„ï¼Œé‚£å°±æ˜¯ä¸¦ä¸æ˜¯é€™æ¨£å°±è¬äº‹ğŸ‘ŒğŸ‘Œäº†ï¼ŒXSS çš„é˜²ç¦¦æ¯”è¼ƒéº»ç…©çš„é»æ˜¯è¦é‡å°ä¸åŒæƒ…å¢ƒåšè™•ç†ï¼Œå¦‚åŒ <a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP: Cross Site Scripting Prevention Cheat Sheet</a> ä¸­æœ‰æåˆ°çš„ï¼Œå¦‚æœä½ çš„è¼¸å‡ºæ˜¯è¦æ”¾åˆ° <code>&lt;a href=&quot;&quot;&gt;</code> è£¡é¢çš„è©±ï¼Œéœ€è¦è€ƒæ…®åˆ° <code>javascript:alert(1)</code> é€™ç¨®å½¢å¼çš„ payloadï¼Œé€™æ™‚å€™ä¸Šé¢çš„ sanitize function å°±æ²’æœ‰ç”¨äº†ã€‚</p>
<h2><span id="çµèª">çµèª</span></h2><p>å…¶å¯¦ä¸€é–‹å§‹æœƒç™¼ç¾åˆ†éŒ¯ï¼Œæ˜¯å› ç‚ºåœ¨ <a target="_blank" rel="noopener" href="https://zeroday.hitcon.org/">HITCON ZeroDay</a> å¹³å°ä¸Šæ‰€å›å ±çš„æ¼æ´åˆ†é¡è¢«æ”¹è®Šï¼Œæ‰è®“æˆ‘æ„è­˜åˆ°è‡ªå·±å°æ–¼é€™å¹¾ç¨®çš„åˆ†æ³•ç†è§£éŒ¯èª¤ï¼Œåœ¨é€™é‚Šä¹Ÿæ„Ÿè¬è² è²¬å¯©æŸ¥çš„å·¥ä½œäººå“¡ã€‚</p>
<p>é™¤äº†é€™å¹¾ç¨®åˆ†æ³•ä»¥å¤–ï¼Œå…¶å¯¦ä¹Ÿæœ‰å…¶ä»–ç¨®çš„åˆ†é¡æ–¹å¼ï¼Œä¾‹å¦‚èªªä½¿ç”¨è€…éœ€è¦è‡ªå·±è¼¸å…¥ XSS payload çš„ Self XSSï¼Œæˆ–è€…æ˜¯åˆ©ç”¨ HTML è§£æä¸ä¸€è‡´è€Œé”æˆçš„ Mutation XSS ç­‰ç­‰ï¼Œå…¶å¯¦éƒ½æ˜¯ XSS å¾ˆæœ‰è¶£çš„æ‡‰ç”¨ï¼Œä»¥å¾Œæœ‰æ©Ÿæœƒå†ä¾†è·Ÿå¤§å®¶åˆ†äº«ã€‚</p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Front-end/">#Front-end</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Security/">#Security</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2021/10/25/learn-frontend-from-security-pov/">æ¥è§¸è³‡å®‰æ‰ç™¼ç¾æˆ‘ä¸æ‡‚å‰ç«¯</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2021/09/29/prototype-pollution/">åŸºæ–¼ JS åŸå‹éˆçš„æ”»æ“Šæ‰‹æ³•ï¼šPrototype Pollution</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">è©•è«–</h3>
    <script src="https://utteranc.es/client.js"
        repo="aszx87410/huli-blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2024 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>ç¹é«”ä¸­æ–‡</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            <!-- NOTE: æ°¸é å›åˆ°é¦–é  -->
            
                <a href="/2021/10/11/en/xss-history/" class="dropdown-item">
                    English
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>



    
    
    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js?v=3.js"></script>


    
</body>
</html>